(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8077],{47407:function(e,t,n){"use strict";n.d(t,{Z:function(){return s}});var o=n(24246),r={src:"/_next/static/media/logo-green.307c8742.svg",height:24,width:21,blurWidth:0,blurHeight:0},l=n(38579),a=n.n(l);function d(e){let{children:t,title:n,darkModePreview:l=!1}=e;return(0,o.jsxs)("div",{className:"col-start-1 col-end-13 sm:col-start-2 sm:col-end-12 xl:col-start-3 xl:col-end-11 h-full bg-white-primary shadow-reactgrid-sample rounded-[16px] overflow-hidden dark:text-white-primary dark:bg-black-primary",children:[(0,o.jsxs)("div",{className:"h-[60px] flex items-center ps-5 gap-6",children:[(0,o.jsx)(a(),{src:r,alt:"ReactGrid"}),(0,o.jsx)("p",{className:"bold font-bold block w-full text-lg ",children:n})]}),(0,o.jsx)("div",{className:"flex h-full overflow-auto ".concat(l?"dark:text-white-primary dark:bg-black-primary":"dark:text-black-primary dark:bg-white-primary"),children:t||"Placeholder."})]})}var i=n(15262);function s(e){let{code:t,scope:n,noInline:r=!0,sideBySide:l=!1,language:a,disabled:s=!1,noPreview:c=!1}=e;return(0,o.jsx)(i.nu,{noInline:r,scope:n,code:t,language:a,disabled:s,children:(0,o.jsxs)("div",{className:"LiveCode flex ".concat(l?"flex-row":"flex-col"," "),style:{gap:"2rem"},children:[(0,o.jsx)(d,{title:"Code",children:(0,o.jsx)(i.uz,{style:{width:"100%",fontFamily:"monospace"}})}),!c&&(0,o.jsx)(d,{title:"Preview",children:(0,o.jsxs)("div",{style:{padding:"2rem"},children:[(0,o.jsx)(i.IF,{}),(0,o.jsx)(i.i5,{})]})})]})})}},95035:function(e,t,n){"use strict";var o=n(24246);let r={useNextSeoProps:()=>({titleTemplate:"%s – React Grid Docs"}),logo:(0,o.jsx)(o.Fragment,{children:(0,o.jsxs)("svg",{width:"21",height:"24",viewBox:"0 0 21 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,o.jsxs)("g",{clipPath:"url(#clip0_401_14556)",children:[(0,o.jsx)("path",{d:"M4.5 4.5H0V6H4.5V4.5Z",fill:"#107C41"}),(0,o.jsx)("path",{d:"M21 4.5H10.5V6H21V4.5Z",fill:"#107C41"}),(0,o.jsx)("path",{d:"M10.5 4.5H6V6H10.5V4.5Z",fill:"#107C41"}),(0,o.jsx)("path",{d:"M18.75 0H2.25V1.5H18.75V0Z",fill:"#107C41"}),(0,o.jsx)("path",{d:"M10.5 12H6V13.5H10.5V12Z",fill:"#107C41"}),(0,o.jsx)("path",{d:"M6 19.5H2.25V21H6V19.5Z",fill:"#107C41"}),(0,o.jsx)("path",{d:"M1.5 18.75L1.5 2.25L4.76837e-07 2.25L4.76837e-07 18.75H1.5Z",fill:"#107C41"}),(0,o.jsx)("path",{d:"M6.00336 21L6.00336 4.5H4.50369L4.50369 21H6.00336Z",fill:"#107C41"}),(0,o.jsx)("path",{d:"M20.7782 22.7187L10.2801 12.2183L9.21968 13.2789L19.7178 23.7793L20.7782 22.7187Z",fill:"#107C41"}),(0,o.jsx)("path",{d:"M6.00336 4.5L6.00336 0L4.50369 0L4.50369 4.5H6.00336Z",fill:"#107C41"}),(0,o.jsx)("path",{d:"M21 2.25H19.5C19.5 1.8375 19.1625 1.5 18.75 1.5V0C19.9969 0 21 1.0125 21 2.25Z",fill:"#107C41"}),(0,o.jsx)("path",{d:"M1.5 2.25H0C0 1.0125 1.0125 0 2.25 0V1.5C1.8375 1.5 1.5 1.8375 1.5 2.25Z",fill:"#107C41"}),(0,o.jsx)("path",{d:"M2.25 21C1.0125 21 0 19.9875 0 18.75H1.5C1.5 19.1625 1.8375 19.5 2.25 19.5V21Z",fill:"#107C41"}),(0,o.jsx)("path",{d:"M5.99866 12H0V13.5H5.99866V12Z",fill:"#107C41"}),(0,o.jsx)("path",{d:"M21 12H15V13.5H21V12Z",fill:"#107C41"}),(0,o.jsx)("path",{d:"M21 13.5L21 2.25L19.5003 2.25L19.5003 13.5H21Z",fill:"#107C41"}),(0,o.jsx)("path",{d:"M10.5 13.5V12C12.15 12 13.5 10.65 13.5 9C13.5 7.35 12.15 6 10.5 6V4.5C12.9844 4.5 15 6.51563 15 9C15 11.4844 12.9844 13.5 10.5 13.5Z",fill:"#107C41"}),(0,o.jsx)("path",{d:"M15 24C11.6906 24 9 21.3094 9 18C9 14.6906 11.6906 12 15 12V13.5C12.5156 13.5 10.5 15.5156 10.5 18C10.5 20.4844 12.5156 22.5 15 22.5V24Z",fill:"#107C41"}),(0,o.jsx)("path",{d:"M21 22.5H16.5V24H21V22.5Z",fill:"#107C41"}),(0,o.jsx)("path",{d:"M21 24V19.5H19.5003V24H21Z",fill:"#107C41"})]}),(0,o.jsx)("defs",{children:(0,o.jsx)("clipPath",{id:"clip0_401_14556",children:(0,o.jsx)("rect",{width:"21",height:"24",fill:"white"})})})]})}),project:{link:"https://github.com/silevis/reactgrid"},primaryHue:{dark:147,light:147},primarySaturation:{dark:27,light:27},footer:{component:null},editLink:{component:null},docsRepositoryBase:"https://github.com/silevis/reactgrid-website/tree/gh-pages-dev",sidebar:{toggleButton:!0},toc:{backToTop:!0},banner:{key:"5.0-release",text:(0,o.jsx)("a",{href:"/docs/5.0/1-getting-started",target:"_blank",children:"\uD83C\uDF89 ReactGrid 5.0 is released. Read more →"})}};t.Z=r},43898:function(){},30178:function(e,t,n){"use strict";let o;n.d(t,{Ge:function(){return n3},M4:function(){return n2},Nf:function(){return n0},Uy:function(){return nD},o7:function(){return ny},pc:function(){return nF},zN:function(){return n4}});var r=n(24246),l=n(27378);!function(){try{if("u">typeof document){var e=document.createElement("style");e.appendChild(document.createTextNode(".rg-input{position:absolute;top:0;left:0;resize:none;overflow-y:hidden;box-sizing:border-box;text-align:center;width:100%;height:100%;background:transparent;border:none;padding:0;outline:none;color:inherit;font-size:inherit;font-family:inherit}")),document.head.appendChild(e)}}catch(e){console.error("vite-plugin-css-injected-by-js",e)}}();var a=Object.defineProperty,d=(e,t,n)=>t in e?a(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,i=(e,t,n)=>(d(e,"symbol"!=typeof t?t+"":t,n),n),s=function(){function e(e){var t=this;this._insertTag=function(e){var n;n=0===t.tags.length?t.insertionPoint?t.insertionPoint.nextSibling:t.prepend?t.container.firstChild:t.before:t.tags[t.tags.length-1].nextSibling,t.container.insertBefore(e,n),t.tags.push(e)},this.isSpeedy=void 0===e.speedy||e.speedy,this.tags=[],this.ctr=0,this.nonce=e.nonce,this.key=e.key,this.container=e.container,this.prepend=e.prepend,this.insertionPoint=e.insertionPoint,this.before=null}var t=e.prototype;return t.hydrate=function(e){e.forEach(this._insertTag)},t.insert=function(e){this.ctr%(this.isSpeedy?65e3:1)==0&&this._insertTag(((t=document.createElement("style")).setAttribute("data-emotion",this.key),void 0!==this.nonce&&t.setAttribute("nonce",this.nonce),t.appendChild(document.createTextNode("")),t.setAttribute("data-s",""),t));var t,n=this.tags[this.tags.length-1];if(this.isSpeedy){var o=function(e){if(e.sheet)return e.sheet;for(var t=0;t<document.styleSheets.length;t++)if(document.styleSheets[t].ownerNode===e)return document.styleSheets[t]}(n);try{o.insertRule(e,o.cssRules.length)}catch{}}else n.appendChild(document.createTextNode(e));this.ctr++},t.flush=function(){this.tags.forEach(function(e){var t;return null==(t=e.parentNode)?void 0:t.removeChild(e)}),this.tags=[],this.ctr=0},e}(),c="-ms-",u="-moz-",f="-webkit-",x="comm",I="rule",p="decl",h="@keyframes",g=Math.abs,w=String.fromCharCode,C=Object.assign;function R(e,t,n){return e.replace(t,n)}function v(e,t){return e.indexOf(t)}function y(e,t){return 0|e.charCodeAt(t)}function m(e,t,n){return e.slice(t,n)}function b(e){return e.length}function S(e,t){return t.push(e),e}var A=1,_=1,L=0,B=0,j=0,k="";function T(e,t,n,o,r,l,a){return{value:e,root:t,parent:n,type:o,props:r,children:l,line:A,column:_,length:a,return:""}}function $(e,t){return C(T("",null,null,"",null,null,0),e,{length:-e.length},t)}function P(){return j=B<L?y(k,B++):0,_++,10===j&&(_=1,A++),j}function O(){return y(k,B)}function E(e){switch(e){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function F(e){return A=_=1,L=b(k=e),B=0,[]}function D(e){var t,n;return(t=B-1,n=function e(t){for(;P();)switch(j){case t:return B;case 34:case 39:34!==t&&39!==t&&e(j);break;case 40:41===t&&e(t);break;case 92:P()}return B}(91===e?e+2:40===e?e+1:e),m(k,t,n)).trim()}function M(e,t,n,o,r,l,a,d,i,s,c){for(var u=r-1,f=0===r?l:[""],x=f.length,p=0,h=0,w=0;p<o;++p)for(var C=0,v=m(e,u+1,u=g(h=a[p])),y=e;C<x;++C)(y=(h>0?f[C]+" "+v:R(v,/&\f/g,f[C])).trim())&&(i[w++]=y);return T(e,t,n,0===r?I:d,i,s,c)}function z(e,t,n,o){return T(e,t,n,p,m(e,0,o),m(e,o+1,-1),o)}function H(e,t){for(var n="",o=e.length,r=0;r<o;r++)n+=t(e[r],r,e,t)||"";return n}function N(e,t,n,o){switch(e.type){case"@layer":if(e.children.length)break;case"@import":case p:return e.return=e.return||e.value;case x:return"";case h:return e.return=e.value+"{"+H(e.children,o)+"}";case I:e.value=e.props.join(",")}return b(n=H(e.children,o))?e.return=e.value+"{"+n+"}":""}var V=function(e,t,n){for(var o=0,r=0;o=r,r=O(),38===o&&12===r&&(t[n]=1),!E(r);)P();return m(k,e,B)},U=function(e,t){var n=-1,o=44;do switch(E(o)){case 0:38===o&&12===O()&&(t[n]=1),e[n]+=V(B-1,t,n);break;case 2:e[n]+=D(o);break;case 4:if(44===o){e[++n]=58===O()?"&\f":"",t[n]=e[n].length;break}default:e[n]+=w(o)}while(o=P());return e},G=function(e,t){var n;return n=U(F(e),t),k="",n},W=new WeakMap,X=function(e){if(!("rule"!==e.type||!e.parent||e.length<1)){for(var t=e.value,n=e.parent,o=e.column===n.column&&e.line===n.line;"rule"!==n.type;)if(!(n=n.parent))return;if(!(1===e.props.length&&58!==t.charCodeAt(0)&&!W.get(n))&&!o){W.set(e,!0);for(var r=[],l=G(t,r),a=n.props,d=0,i=0;d<l.length;d++)for(var s=0;s<a.length;s++,i++)e.props[i]=r[d]?l[d].replace(/&\f/g,a[s]):a[s]+" "+l[d]}}},Z=function(e){if("decl"===e.type){var t=e.value;108===t.charCodeAt(0)&&98===t.charCodeAt(2)&&(e.return="",e.value="")}},Y=[function(e,t,n,o){if(e.length>-1&&!e.return)switch(e.type){case p:e.return=function e(t,n){switch(45^y(t,0)?(((n<<2^y(t,0))<<2^y(t,1))<<2^y(t,2))<<2^y(t,3):0){case 5103:return f+"print-"+t+t;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return f+t+t;case 5349:case 4246:case 4810:case 6968:case 2756:return f+t+u+t+c+t+t;case 6828:case 4268:return f+t+c+t+t;case 6165:return f+t+c+"flex-"+t+t;case 5187:return f+t+R(t,/(\w+).+(:[^]+)/,f+"box-$1$2"+c+"flex-$1$2")+t;case 5443:return f+t+c+"flex-item-"+R(t,/flex-|-self/,"")+t;case 4675:return f+t+c+"flex-line-pack"+R(t,/align-content|flex-|-self/,"")+t;case 5548:return f+t+c+R(t,"shrink","negative")+t;case 5292:return f+t+c+R(t,"basis","preferred-size")+t;case 6060:return f+"box-"+R(t,"-grow","")+f+t+c+R(t,"grow","positive")+t;case 4554:return f+R(t,/([^-])(transform)/g,"$1"+f+"$2")+t;case 6187:return R(R(R(t,/(zoom-|grab)/,f+"$1"),/(image-set)/,f+"$1"),t,"")+t;case 5495:case 3959:return R(t,/(image-set\([^]*)/,f+"$1$`$1");case 4968:return R(R(t,/(.+:)(flex-)?(.*)/,f+"box-pack:$3"+c+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+f+t+t;case 4095:case 3583:case 4068:case 2532:return R(t,/(.+)-inline(.+)/,f+"$1$2")+t;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(b(t)-1-n>6)switch(y(t,n+1)){case 109:if(45!==y(t,n+4))break;case 102:return R(t,/(.+:)(.+)-([^]+)/,"$1"+f+"$2-$3$1"+u+(108==y(t,n+3)?"$3":"$2-$3"))+t;case 115:return~v(t,"stretch")?e(R(t,"stretch","fill-available"),n)+t:t}break;case 4949:if(115!==y(t,n+1))break;case 6444:switch(y(t,b(t)-3-(~v(t,"!important")&&10))){case 107:return R(t,":",":"+f)+t;case 101:return R(t,/(.+:)([^;!]+)(;|!.+)?/,"$1"+f+(45===y(t,14)?"inline-":"")+"box$3$1"+f+"$2$3$1"+c+"$2box$3")+t}break;case 5936:switch(y(t,n+11)){case 114:return f+t+c+R(t,/[svh]\w+-[tblr]{2}/,"tb")+t;case 108:return f+t+c+R(t,/[svh]\w+-[tblr]{2}/,"tb-rl")+t;case 45:return f+t+c+R(t,/[svh]\w+-[tblr]{2}/,"lr")+t}return f+t+c+t+t}return t}(e.value,e.length);break;case h:return H([$(e,{value:R(e.value,"@","@"+f)})],o);case I:if(e.length){var r,l;return r=e.props,l=function(t){var n;switch(n=t,(n=/(::plac\w+|:read-\w+)/.exec(n))?n[0]:n){case":read-only":case":read-write":return H([$(e,{props:[R(t,/:(read-\w+)/,":"+u+"$1")]})],o);case"::placeholder":return H([$(e,{props:[R(t,/:(plac\w+)/,":"+f+"input-$1")]}),$(e,{props:[R(t,/:(plac\w+)/,":"+u+"$1")]}),$(e,{props:[R(t,/:(plac\w+)/,c+"input-$1")]})],o)}return""},r.map(l).join("")}}}],q="u">typeof globalThis?globalThis:"u">typeof window?window:"u">typeof global?global:"u">typeof self?self:{};function K(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var J={exports:{}},Q={};J.exports=function(){if(eI)return Q;eI=1;var e="function"==typeof Symbol&&Symbol.for,t=e?Symbol.for("react.element"):60103,n=e?Symbol.for("react.portal"):60106,o=e?Symbol.for("react.fragment"):60107,r=e?Symbol.for("react.strict_mode"):60108,l=e?Symbol.for("react.profiler"):60114,a=e?Symbol.for("react.provider"):60109,d=e?Symbol.for("react.context"):60110,i=e?Symbol.for("react.async_mode"):60111,s=e?Symbol.for("react.concurrent_mode"):60111,c=e?Symbol.for("react.forward_ref"):60112,u=e?Symbol.for("react.suspense"):60113,f=e?Symbol.for("react.suspense_list"):60120,x=e?Symbol.for("react.memo"):60115,I=e?Symbol.for("react.lazy"):60116,p=e?Symbol.for("react.block"):60121,h=e?Symbol.for("react.fundamental"):60117,g=e?Symbol.for("react.responder"):60118,w=e?Symbol.for("react.scope"):60119;function C(e){if("object"==typeof e&&null!==e){var f=e.$$typeof;switch(f){case t:switch(e=e.type){case i:case s:case o:case l:case r:case u:return e;default:switch(e=e&&e.$$typeof){case d:case c:case I:case x:case a:return e;default:return f}}case n:return f}}}function R(e){return C(e)===s}return Q.AsyncMode=i,Q.ConcurrentMode=s,Q.ContextConsumer=d,Q.ContextProvider=a,Q.Element=t,Q.ForwardRef=c,Q.Fragment=o,Q.Lazy=I,Q.Memo=x,Q.Portal=n,Q.Profiler=l,Q.StrictMode=r,Q.Suspense=u,Q.isAsyncMode=function(e){return R(e)||C(e)===i},Q.isConcurrentMode=R,Q.isContextConsumer=function(e){return C(e)===d},Q.isContextProvider=function(e){return C(e)===a},Q.isElement=function(e){return"object"==typeof e&&null!==e&&e.$$typeof===t},Q.isForwardRef=function(e){return C(e)===c},Q.isFragment=function(e){return C(e)===o},Q.isLazy=function(e){return C(e)===I},Q.isMemo=function(e){return C(e)===x},Q.isPortal=function(e){return C(e)===n},Q.isProfiler=function(e){return C(e)===l},Q.isStrictMode=function(e){return C(e)===r},Q.isSuspense=function(e){return C(e)===u},Q.isValidElementType=function(e){return"string"==typeof e||"function"==typeof e||e===o||e===s||e===l||e===r||e===u||e===f||"object"==typeof e&&null!==e&&(e.$$typeof===I||e.$$typeof===x||e.$$typeof===a||e.$$typeof===d||e.$$typeof===c||e.$$typeof===h||e.$$typeof===g||e.$$typeof===w||e.$$typeof===p)},Q.typeOf=C,Q}();var ee=J.exports,et={};et[ee.ForwardRef]={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},et[ee.Memo]={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0};var en=function(e,t,n){var o=e.key+"-"+t.name;!1===n&&void 0===e.registered[o]&&(e.registered[o]=t.styles)},eo=function(e,t,n){en(e,t,n);var o=e.key+"-"+t.name;if(void 0===e.inserted[t.name]){var r=t;do e.insert(t===r?"."+o:"",r,e.sheet,!0),r=r.next;while(void 0!==r)}},er={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},el=/[A-Z]|^ms/g,ea=/_EMO_([^_]+?)_([^]*?)_EMO_/g,ed=function(e){return 45===e.charCodeAt(1)},ei=function(e){return null!=e&&"boolean"!=typeof e},es=(ef=function(e){return ed(e)?e:e.replace(el,"-$&").toLowerCase()},ex=Object.create(null),function(e){return void 0===ex[e]&&(ex[e]=ef(e)),ex[e]}),ec=function(e,t){switch(e){case"animation":case"animationName":if("string"==typeof t)return t.replace(ea,function(e,t,n){return ep={name:t,styles:n,next:ep},t})}return 1===er[e]||ed(e)||"number"!=typeof t||0===t?t:t+"px"};function eu(e,t,n){if(null==n)return"";if(void 0!==n.__emotion_styles)return n;switch(typeof n){case"boolean":return"";case"object":if(1===n.anim)return ep={name:n.name,styles:n.styles,next:ep},n.name;if(void 0!==n.styles){var o=n.next;if(void 0!==o)for(;void 0!==o;)ep={name:o.name,styles:o.styles,next:ep},o=o.next;return n.styles+";"}return function(e,t,n){var o="";if(Array.isArray(n))for(var r=0;r<n.length;r++)o+=eu(e,t,n[r])+";";else for(var l in n){var a=n[l];if("object"!=typeof a)null!=t&&void 0!==t[a]?o+=l+"{"+t[a]+"}":ei(a)&&(o+=es(l)+":"+ec(l,a)+";");else if(Array.isArray(a)&&"string"==typeof a[0]&&(null==t||void 0===t[a[0]]))for(var d=0;d<a.length;d++)ei(a[d])&&(o+=es(l)+":"+ec(l,a[d])+";");else{var i=eu(e,t,a);switch(l){case"animation":case"animationName":o+=es(l)+":"+i+";";break;default:o+=l+"{"+i+"}"}}}return o}(e,t,n);case"function":if(void 0!==e){var r=ep,l=n(e);return ep=r,eu(e,t,l)}}if(null==t)return n;var a=t[n];return void 0!==a?a:n}var ef,ex,eI,ep,eh=/label:\s*([^\s;\n{]+)\s*(;|$)/g;function eg(e,t,n){if(1===e.length&&"object"==typeof e[0]&&null!==e[0]&&void 0!==e[0].styles)return e[0];var o=!0,r="";ep=void 0;var l=e[0];null==l||void 0===l.raw?(o=!1,r+=eu(n,t,l)):r+=l[0];for(var a=1;a<e.length;a++)r+=eu(n,t,e[a]),o&&(r+=l[a]);eh.lastIndex=0;for(var d,i="";null!==(d=eh.exec(r));)i+="-"+d[1];return{name:function(e){for(var t,n=0,o=0,r=e.length;r>=4;++o,r-=4)t=(65535&(t=255&e.charCodeAt(o)|(255&e.charCodeAt(++o))<<8|(255&e.charCodeAt(++o))<<16|(255&e.charCodeAt(++o))<<24))*1540483477+((t>>>16)*59797<<16),t^=t>>>24,n=(65535&t)*1540483477+((t>>>16)*59797<<16)^(65535&n)*1540483477+((n>>>16)*59797<<16);switch(r){case 3:n^=(255&e.charCodeAt(o+2))<<16;case 2:n^=(255&e.charCodeAt(o+1))<<8;case 1:n^=255&e.charCodeAt(o),n=(65535&n)*1540483477+((n>>>16)*59797<<16)}return n^=n>>>13,(((n=(65535&n)*1540483477+((n>>>16)*59797<<16))^n>>>15)>>>0).toString(36)}(r)+i,styles:r,next:ep}}var ew=!!l.useInsertionEffect&&l.useInsertionEffect||function(e){return e()},eC=l.createContext("u">typeof HTMLElement?function(e){var t=e.key;if("css"===t){var n=document.querySelectorAll("style[data-emotion]:not([data-s])");Array.prototype.forEach.call(n,function(e){-1!==e.getAttribute("data-emotion").indexOf(" ")&&(document.head.appendChild(e),e.setAttribute("data-s",""))})}var o,r=e.stylisPlugins||Y,l={},a=[];o=e.container||document.head,Array.prototype.forEach.call(document.querySelectorAll('style[data-emotion^="'+t+' "]'),function(e){for(var t=e.getAttribute("data-emotion").split(" "),n=1;n<t.length;n++)l[t[n]]=!0;a.push(e)});var d,i,c,u,f,I=(i=(d=[X,Z].concat(r,[N,(u=function(e){f.insert(e)},function(e){e.root||(e=e.return)&&u(e)})])).length,function(e,t,n,o){for(var r="",l=0;l<i;l++)r+=d[l](e,t,n,o)||"";return r}),p=function(e){var t,n;return H((n=function e(t,n,o,r,l,a,d,i,s){for(var c,u=0,f=0,I=d,p=0,h=0,g=0,C=1,L=1,$=1,F=0,H="",N=l,V=a,U=r,G=H;L;)switch(g=F,F=P()){case 40:if(108!=g&&58==y(G,I-1)){-1!=v(G+=R(D(F),"&","&\f"),"&\f")&&($=-1);break}case 34:case 39:case 91:G+=D(F);break;case 9:case 10:case 13:case 32:G+=function(e){for(;(j=O())&&j<33;)P();return E(e)>2||E(j)>3?"":" "}(g);break;case 92:G+=function(e,t){for(var n;--t&&P()&&!(j<48||j>102||j>57&&j<65||j>70&&j<97););return n=B+(t<6&&32==O()&&32==P()),m(k,e,n)}(B-1,7);continue;case 47:switch(O()){case 42:case 47:S(T(c=function(e,t){for(;P()&&e+j!==57&&(e+j!==84||47!==O()););return"/*"+m(k,t,B-1)+"*"+w(47===e?e:P())}(P(),B),n,o,x,w(j),m(c,2,-2),0),s);break;default:G+="/"}break;case 123*C:i[u++]=b(G)*$;case 125*C:case 59:case 0:switch(F){case 0:case 125:L=0;case 59+f:-1==$&&(G=R(G,/\f/g,"")),h>0&&b(G)-I&&S(h>32?z(G+";",r,o,I-1):z(R(G," ","")+";",r,o,I-2),s);break;case 59:G+=";";default:if(S(U=M(G,n,o,u,f,l,i,H,N=[],V=[],I),a),123===F){if(0===f)e(G,n,U,U,N,a,I,i,V);else switch(99===p&&110===y(G,3)?100:p){case 100:case 108:case 109:case 115:e(t,U,U,r&&S(M(t,U,U,0,0,l,i,H,l,N=[],I),V),l,V,I,i,r?N:V);break;default:e(G,U,U,U,[""],V,0,i,V)}}}u=f=h=0,C=$=1,H=G="",I=d;break;case 58:I=1+b(G),h=g;default:if(C<1){if(123==F)--C;else if(125==F&&0==C++&&125==(j=B>0?y(k,--B):0,_--,10===j&&(_=1,A--),j))continue}switch(G+=w(F),F*C){case 38:$=f>0?1:(G+="\f",-1);break;case 44:i[u++]=(b(G)-1)*$,$=1;break;case 64:45===O()&&(G+=D(P())),p=O(),f=I=b(H=G+=function(e){for(;!E(O());)P();return m(k,e,B)}(B)),F++;break;case 45:45===g&&2==b(G)&&(C=0)}}return a}("",null,null,null,[""],t=F(t=e),0,[0],t),k="",n),I)};c=function(e,t,n,o){f=n,p(e?e+"{"+t.styles+"}":t.styles),o&&(h.inserted[t.name]=!0)};var h={key:t,sheet:new s({key:t,container:o,nonce:e.nonce,speedy:e.speedy,prepend:e.prepend,insertionPoint:e.insertionPoint}),nonce:e.nonce,inserted:l,registered:{},insert:c};return h.sheet.hydrate(a),h}({key:"css"}):null);eC.Provider;var eR=l.createContext({}),ev={}.hasOwnProperty,ey="__EMOTION_TYPE_PLEASE_DO_NOT_USE__",em=function(e,t){var n={};for(var o in t)ev.call(t,o)&&(n[o]=t[o]);return n[ey]=e,n},eb=function(e){var t=e.cache,n=e.serialized,o=e.isStringTag;return en(t,n,o),ew(function(){return eo(t,n,o)}),null},eS=(nW=function(e,t,n){var o,r,a,d=e.css;"string"==typeof d&&void 0!==t.registered[d]&&(d=t.registered[d]);var i=e[ey],s=[d],c="";"string"==typeof e.className?(o=t.registered,r=e.className,a="",r.split(" ").forEach(function(e){void 0!==o[e]?s.push(o[e]+";"):a+=e+" "}),c=a):null!=e.className&&(c=e.className+" ");var u=eg(s,void 0,l.useContext(eR));c+=t.key+"-"+u.name;var f={};for(var x in e)ev.call(e,x)&&"css"!==x&&x!==ey&&(f[x]=e[x]);return f.className=c,n&&(f.ref=n),l.createElement(l.Fragment,null,l.createElement(eb,{cache:t,serialized:u,isStringTag:"string"==typeof i}),l.createElement(i,f))},(0,l.forwardRef)(function(e,t){return nW(e,(0,l.useContext)(eC),t)})),eA=r.Fragment;function e_(e,t,n){return ev.call(t,"css")?r.jsx(eS,em(e,t),n):r.jsx(e,t,n)}function eL(e,t,n){return ev.call(t,"css")?r.jsxs(eS,em(e,t),n):r.jsxs(e,t,n)}class eB extends l.Component{constructor(){super(...arguments),i(this,"state",{hasError:!1})}static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e,t){this.setState({error:e,errorInfo:t})}render(){let{hasError:e,errorInfo:t,error:n}=this.state;return e?eL(eA,{children:[e_("h1",{children:null==n?void 0:n.message}),eL("details",{children:[null==n?void 0:n.stack,null==t?void 0:t.componentStack]})]}):this.props.children}}let ej=(e,t)=>e.startRowIdx===t.startRowIdx&&e.endRowIdx===t.endRowIdx&&e.startColIdx===t.startColIdx&&e.endColIdx===t.endColIdx,ek={startRowIdx:-1,endRowIdx:-1,startColIdx:-1,endColIdx:-1},eT={rowIndex:-1,colIndex:-1};function e$(e,t){let{start:n,end:o}=t,r=e.getCellByIndexes(n.rowIndex,n.columnIndex),l=e.getCellByIndexes(o.rowIndex,o.columnIndex);if(r){if(!l)throw Error("Could not find a endCell with provided indexes")}else throw Error("Could not find a startCell with provided indexes");let a={startRowIdx:n.rowIndex,startColIdx:n.columnIndex,endRowIdx:o.rowIndex,endColIdx:o.columnIndex};return ej(a,ek)&&console.warn("Each of numerical range properties is -1!"),a}function eP(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return eg(t)}let eO=e=>{let t;let n=new Set,o=(e,o)=>{let r="function"==typeof e?e(t):e;if(!Object.is(r,t)){let e=t;t=o??("object"!=typeof r||null===r)?r:Object.assign({},t,r),n.forEach(n=>n(t,e))}},r=()=>t,l={setState:o,getState:r,getInitialState:()=>a,subscribe:e=>(n.add(e),()=>n.delete(e)),destroy:()=>{n.clear()}},a=t=e(o,r,l);return l},eE=e=>e?eO(e):eO;var eF={exports:{}},eD={},eM={exports:{}},ez={};eF.exports=function(){if(nY)return eD;nY=1;var e=(nZ||(nZ=1,eM.exports=function(){if(nX)return ez;nX=1;var e="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},t=l.useState,n=l.useEffect,o=l.useLayoutEffect,r=l.useDebugValue;function a(t){var n=t.getSnapshot;t=t.value;try{var o=n();return!e(t,o)}catch{return!0}}var d=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?function(e,t){return t()}:function(e,l){var d=l(),i=t({inst:{value:d,getSnapshot:l}}),s=i[0].inst,c=i[1];return o(function(){s.value=d,s.getSnapshot=l,a(s)&&c({inst:s})},[e,d,l]),n(function(){return a(s)&&c({inst:s}),e(function(){a(s)&&c({inst:s})})},[e]),r(d),d};return ez.useSyncExternalStore=void 0!==l.useSyncExternalStore?l.useSyncExternalStore:d,ez}()),eM.exports),t="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},n=e.useSyncExternalStore,o=l.useRef,r=l.useEffect,a=l.useMemo,d=l.useDebugValue;return eD.useSyncExternalStoreWithSelector=function(e,l,i,s,c){var u=o(null);if(null===u.current){var f={hasValue:!1,value:null};u.current=f}else f=u.current;var x=n(e,(u=a(function(){function e(e){if(!r){if(r=!0,n=e,e=s(e),void 0!==c&&f.hasValue){var l=f.value;if(c(l,e))return o=l}return o=e}if(l=o,t(n,e))return l;var a=s(e);return void 0!==c&&c(l,a)?l:(n=e,o=a)}var n,o,r=!1,a=void 0===i?null:i;return[function(){return e(l())},null===a?void 0:function(){return e(a())}]},[l,i,s,c]))[0],u[1]);return r(function(){f.hasValue=!0,f.value=x},[x]),d(x),x},eD}();let eH=K(eF.exports),{useDebugValue:eN}=l,{useSyncExternalStoreWithSelector:eV}=eH,eU=e=>e;function eG(e,t=eU,n){let o=eV(e.subscribe,e.getState,e.getServerState||e.getInitialState,t,n);return eN(o),o}let eW=e=>{let t="function"==typeof e?eE(e):e,n=(e,n)=>eG(t,e,n);return Object.assign(n,t),n};var eX={exports:{}};eX.exports,function(e,t){var n,o,r,l="__lodash_hash_undefined__",a="[object Arguments]",d="[object Array]",i="[object Boolean]",s="[object Date]",c="[object Error]",u="[object Function]",f="[object Map]",x="[object Number]",I="[object Object]",p="[object Promise]",h="[object RegExp]",g="[object Set]",w="[object String]",C="[object WeakMap]",R="[object ArrayBuffer]",v="[object DataView]",y=/^\[object .+?Constructor\]$/,m=/^(?:0|[1-9]\d*)$/,b={};b["[object Float32Array]"]=b["[object Float64Array]"]=b["[object Int8Array]"]=b["[object Int16Array]"]=b["[object Int32Array]"]=b["[object Uint8Array]"]=b["[object Uint8ClampedArray]"]=b["[object Uint16Array]"]=b["[object Uint32Array]"]=!0,b[a]=b[d]=b[R]=b[i]=b[v]=b[s]=b[c]=b[u]=b[f]=b[x]=b[I]=b[h]=b[g]=b[w]=b[C]=!1;var S="object"==typeof q&&q&&q.Object===Object&&q,A="object"==typeof self&&self&&self.Object===Object&&self,_=S||A||Function("return this")(),L=t&&!t.nodeType&&t,B=L&&e&&!e.nodeType&&e,j=B&&B.exports===L,k=j&&S.process,T=function(){try{return k&&k.binding&&k.binding("util")}catch{}}(),$=T&&T.isTypedArray;function P(e){var t=-1,n=Array(e.size);return e.forEach(function(e,o){n[++t]=[o,e]}),n}function O(e){var t=-1,n=Array(e.size);return e.forEach(function(e){n[++t]=e}),n}var E=Array.prototype,F=Function.prototype,D=Object.prototype,M=_["__core-js_shared__"],z=F.toString,H=D.hasOwnProperty,N=(n=/[^.]+$/.exec(M&&M.keys&&M.keys.IE_PROTO||""))?"Symbol(src)_1."+n:"",V=D.toString,U=RegExp("^"+z.call(H).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),G=j?_.Buffer:void 0,W=_.Symbol,X=_.Uint8Array,Z=D.propertyIsEnumerable,Y=E.splice,K=W?W.toStringTag:void 0,J=Object.getOwnPropertySymbols,Q=G?G.isBuffer:void 0,ee=(o=Object.keys,r=Object,function(e){return o(r(e))}),et=eS(_,"DataView"),en=eS(_,"Map"),eo=eS(_,"Promise"),er=eS(_,"Set"),el=eS(_,"WeakMap"),ea=eS(Object,"create"),ed=eL(et),ei=eL(en),es=eL(eo),ec=eL(er),eu=eL(el),ef=W?W.prototype:void 0,ex=ef?ef.valueOf:void 0;function eI(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var o=e[t];this.set(o[0],o[1])}}function ep(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var o=e[t];this.set(o[0],o[1])}}function eh(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var o=e[t];this.set(o[0],o[1])}}function eg(e){var t=-1,n=null==e?0:e.length;for(this.__data__=new eh;++t<n;)this.add(e[t])}function ew(e){var t=this.__data__=new ep(e);this.size=t.size}function eC(e,t){for(var n=e.length;n--;)if(eB(e[n][0],t))return n;return -1}function eR(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":K&&K in Object(e)?function(e){var t=H.call(e,K),n=e[K];try{e[K]=void 0;var o=!0}catch{}var r=V.call(e);return o&&(t?e[K]=n:delete e[K]),r}(e):V.call(e)}function ev(e){return eE(e)&&eR(e)==a}function ey(e,t,n,o,r,l){var a=1&n,d=e.length,i=t.length;if(d!=i&&!(a&&i>d))return!1;var s=l.get(e);if(s&&l.get(t))return s==t;var c=-1,u=!0,f=2&n?new eg:void 0;for(l.set(e,t),l.set(t,e);++c<d;){var x=e[c],I=t[c];if(o)var p=a?o(I,x,c,t,e,l):o(x,I,c,e,t,l);if(void 0!==p){if(p)continue;u=!1;break}if(f){if(!function(e,t){for(var n=-1,o=null==e?0:e.length;++n<o;)if(t(e[n],n,e))return!0;return!1}(t,function(e,t){if(!f.has(t)&&(x===e||r(x,e,n,o,l)))return f.push(t)})){u=!1;break}}else if(!(x===I||r(x,I,n,o,l))){u=!1;break}}return l.delete(e),l.delete(t),u}function em(e){var t;return t=function(e){return null!=e&&eP(e.length)&&!e$(e)?function(e,t){var n,o=ek(e),r=!o&&ej(e),l=!o&&!r&&eT(e),a=!o&&!r&&!l&&eF(e),d=o||r||l||a,i=d?function(e,t){for(var n=-1,o=Array(e);++n<e;)o[n]=t(n);return o}(e.length,String):[],s=i.length;for(var c in e)H.call(e,c)&&!(d&&("length"==c||l&&("offset"==c||"parent"==c)||a&&("buffer"==c||"byteLength"==c||"byteOffset"==c)||(n=(n=s)??9007199254740991)&&("number"==typeof c||m.test(c))&&c>-1&&c%1==0&&c<n))&&i.push(c);return i}(e):function(e){if(t=e&&e.constructor,e!==("function"==typeof t&&t.prototype||D))return ee(e);var t,n=[];for(var o in Object(e))H.call(e,o)&&"constructor"!=o&&n.push(o);return n}(e)}(e),ek(e)?t:function(e,t){for(var n=-1,o=t.length,r=e.length;++n<o;)e[r+n]=t[n];return e}(t,eA(e))}function eb(e,t){var n,o=e.__data__;return("string"==(n=typeof t)||"number"==n||"symbol"==n||"boolean"==n?"__proto__"!==t:null===t)?o["string"==typeof t?"string":"hash"]:o.map}function eS(e,t){var n=null==e?void 0:e[t];return!(!eO(n)||N&&N in n)&&(e$(n)?U:y).test(eL(n))?n:void 0}eI.prototype.clear=function(){this.__data__=ea?ea(null):{},this.size=0},eI.prototype.delete=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},eI.prototype.get=function(e){var t=this.__data__;if(ea){var n=t[e];return n===l?void 0:n}return H.call(t,e)?t[e]:void 0},eI.prototype.has=function(e){var t=this.__data__;return ea?void 0!==t[e]:H.call(t,e)},eI.prototype.set=function(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=ea&&void 0===t?l:t,this},ep.prototype.clear=function(){this.__data__=[],this.size=0},ep.prototype.delete=function(e){var t=this.__data__,n=eC(t,e);return!(n<0)&&(n==t.length-1?t.pop():Y.call(t,n,1),--this.size,!0)},ep.prototype.get=function(e){var t=this.__data__,n=eC(t,e);return n<0?void 0:t[n][1]},ep.prototype.has=function(e){return eC(this.__data__,e)>-1},ep.prototype.set=function(e,t){var n=this.__data__,o=eC(n,e);return o<0?(++this.size,n.push([e,t])):n[o][1]=t,this},eh.prototype.clear=function(){this.size=0,this.__data__={hash:new eI,map:new(en||ep),string:new eI}},eh.prototype.delete=function(e){var t=eb(this,e).delete(e);return this.size-=t?1:0,t},eh.prototype.get=function(e){return eb(this,e).get(e)},eh.prototype.has=function(e){return eb(this,e).has(e)},eh.prototype.set=function(e,t){var n=eb(this,e),o=n.size;return n.set(e,t),this.size+=n.size==o?0:1,this},eg.prototype.add=eg.prototype.push=function(e){return this.__data__.set(e,l),this},eg.prototype.has=function(e){return this.__data__.has(e)},ew.prototype.clear=function(){this.__data__=new ep,this.size=0},ew.prototype.delete=function(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n},ew.prototype.get=function(e){return this.__data__.get(e)},ew.prototype.has=function(e){return this.__data__.has(e)},ew.prototype.set=function(e,t){var n=this.__data__;if(n instanceof ep){var o=n.__data__;if(!en||o.length<199)return o.push([e,t]),this.size=++n.size,this;n=this.__data__=new eh(o)}return n.set(e,t),this.size=n.size,this};var eA=J?function(e){return null==e?[]:function(e,t){for(var n=-1,o=null==e?0:e.length,r=0,l=[];++n<o;){var a=e[n];t(a,n,e)&&(l[r++]=a)}return l}(J(e=Object(e)),function(t){return Z.call(e,t)})}:function(){return[]},e_=eR;function eL(e){if(null!=e){try{return z.call(e)}catch{}try{return e+""}catch{}}return""}function eB(e,t){return e===t||e!=e&&t!=t}(et&&e_(new et(new ArrayBuffer(1)))!=v||en&&e_(new en)!=f||eo&&e_(eo.resolve())!=p||er&&e_(new er)!=g||el&&e_(new el)!=C)&&(e_=function(e){var t=eR(e),n=t==I?e.constructor:void 0,o=n?eL(n):"";if(o)switch(o){case ed:return v;case ei:return f;case es:return p;case ec:return g;case eu:return C}return t});var ej=ev(function(){return arguments}())?ev:function(e){return eE(e)&&H.call(e,"callee")&&!Z.call(e,"callee")},ek=Array.isArray,eT=Q||function(){return!1};function e$(e){if(!eO(e))return!1;var t=eR(e);return t==u||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t}function eP(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991}function eO(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}function eE(e){return null!=e&&"object"==typeof e}var eF=$?function(e){return $(e)}:function(e){return eE(e)&&eP(e.length)&&!!b[eR(e)]};e.exports=function(e,t){return function e(t,n,o,r,l){return t===n||(null!=t&&null!=n&&(eE(t)||eE(n))?function(e,t,n,o,r,l){var u=ek(e),p=ek(t),C=u?d:e_(e),y=p?d:e_(t);C=C==a?I:C,y=y==a?I:y;var m=C==I,b=y==I,S=C==y;if(S&&eT(e)){if(!eT(t))return!1;u=!0,m=!1}if(S&&!m)return l||(l=new ew),u||eF(e)?ey(e,t,n,o,r,l):function(e,t,n,o,r,l,a){switch(n){case v:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)break;e=e.buffer,t=t.buffer;case R:return!(e.byteLength!=t.byteLength||!l(new X(e),new X(t)));case i:case s:case x:return eB(+e,+t);case c:return e.name==t.name&&e.message==t.message;case h:case w:return e==t+"";case f:var d=P;case g:var u=1&o;if(d||(d=O),e.size!=t.size&&!u)break;var I=a.get(e);if(I)return I==t;o|=2,a.set(e,t);var p=ey(d(e),d(t),o,r,l,a);return a.delete(e),p;case"[object Symbol]":if(ex)return ex.call(e)==ex.call(t)}return!1}(e,t,C,n,o,r,l);if(!(1&n)){var A=m&&H.call(e,"__wrapped__"),_=b&&H.call(t,"__wrapped__");if(A||_){var L=A?e.value():e,B=_?t.value():t;return l||(l=new ew),r(L,B,n,o,l)}}return!!S&&(l||(l=new ew),function(e,t,n,o,r,l){var a=1&n,d=em(e),i=d.length;if(i!=em(t).length&&!a)return!1;for(var s=i;s--;){var c=d[s];if(!(a?c in t:H.call(t,c)))return!1}var u=l.get(e);if(u&&l.get(t))return u==t;var f=!0;l.set(e,t),l.set(t,e);for(var x=a;++s<i;){var I=e[c=d[s]],p=t[c];if(o)var h=a?o(p,I,c,t,e,l):o(I,p,c,e,t,l);if(!(void 0===h?I===p||r(I,p,n,o,l):h)){f=!1;break}x||(x="constructor"==c)}if(f&&!x){var g=e.constructor,w=t.constructor;g!=w&&"constructor"in e&&"constructor"in t&&!("function"==typeof g&&g instanceof g&&"function"==typeof w&&w instanceof w)&&(f=!1)}return l.delete(e),l.delete(t),f}(e,t,n,o,r,l))}(t,n,o,r,e,l):t!=t&&n!=n)}(e,t)}}(eX,eX.exports);let eZ=K(eX.exports),eY=e=>"rowSpan"in e||"colSpan"in e,eq=e=>!!e&&"originRowIndex"in e&&"originColIndex"in e,eK=(e,t)=>eq(t)?e.getCellByIndexes(t.originRowIndex,t.originColIndex):t,eJ=(e,t)=>{if(!t)return ek;let n=eK(e,t);return eY(n)?{startRowIdx:n.rowIndex,endRowIdx:n.rowIndex+((null==n?void 0:n.rowSpan)??1),startColIdx:n.colIndex,endColIdx:n.colIndex+((null==n?void 0:n.colSpan)??1)}:{startRowIdx:n.rowIndex,endRowIdx:n.rowIndex+1,startColIdx:n.colIndex,endColIdx:n.colIndex+1}},eQ=(e,t)=>{let n=!1,o={...t};for(let r=t.startRowIdx;r<t.endRowIdx;r++)for(let l=t.startColIdx;l<t.endColIdx;l++){let t=e.getCellByIndexes(r,l);if(!t)continue;let a=eJ(e,t);a.startRowIdx<o.startRowIdx&&(o.startRowIdx=a.startRowIdx,n=!0),a.endRowIdx>o.endRowIdx&&(o.endRowIdx=a.endRowIdx,n=!0),a.startColIdx<o.startColIdx&&(o.startColIdx=a.startColIdx,n=!0),a.endColIdx>o.endColIdx&&(o.endColIdx=a.endColIdx,n=!0)}return n?eQ(e,o):o};function e0(e,t){var n;if(!e.reactGridRef)return;let o=null==(n=e.reactGridRef)?void 0:n.getElementsByClassName(`rgRowIdx-${t.rowIndex} rgColIdx-${t.colIndex}`);if(!(!o||(null==o?void 0:o.length)===0)){if((null==o?void 0:o.length)!==1)throw Error("Cell container is not unique!");return o[0]}}let e1=(e,t)=>{for(let n of document.elementsFromPoint(e,t)){if(n.classList.contains("rgCellContainer"))return n;if(n.closest(".rgCellContainer"))return n.closest(".rgCellContainer")}return null};function e5(e){let t=/rgRowIdx-(\d+)/.exec(e.classList.value),n=/rgColIdx-(\d+)/.exec(e.classList.value);return t&&n?{rowIndex:parseInt(t[1]),colIndex:parseInt(n[1])}:{rowIndex:-1,colIndex:-1}}let e2=(e,t)=>{let n={rowIndex:-1,colIndex:-1},o=e1(e,t);if(!o)return n;let r=e5(o);if(!r)return n;let{rowIndex:l,colIndex:a}=r;return{rowIndex:l,colIndex:a}},e4=(e,t)=>document.elementsFromPoint(e,t).filter(e=>e.classList.contains("rgCellContainer")).find(e=>{var t;return null==(t=e.closest(".rgPane"))?void 0:t.classList.contains("rgPane-Center")}),e3=(e,t)=>{if(!t)return null;let n=e0(e,t);if(!n)return null;let o=e5(n);for(let t in e.paneRanges){let n=e.paneRanges[t];if(o.rowIndex>=n.startRowIdx&&o.rowIndex<n.endRowIdx&&o.colIndex>=n.startColIdx&&o.colIndex<n.endColIdx)return t}return null},e6=(e,t,n)=>{if(!t||eZ(n,ek))return!1;let o=eJ(e,t);return o.startRowIdx>=n.startRowIdx&&o.endRowIdx<=n.endRowIdx&&o.startColIdx>=n.startColIdx&&o.endColIdx<=n.endColIdx},e9=(e,t)=>{let n=getComputedStyle(e),o="absolute"===n.position,r=t?/(auto|scroll|hidden)/:/(auto|scroll)/;if("fixed"===n.position)return document.documentElement;for(let t=e;t=t.parentElement;)if(n=getComputedStyle(t),!(o&&"static"===n.position)&&r.test(n.overflow+n.overflowY+n.overflowX))return t;return e7()},e7=()=>window,e8=(e,t)=>{let n=0,o=0;switch(e.toLowerCase()){case"left":n=-1;break;case"right":n=1;break;case"top":case"topcenter":o=-1;break;case"bottom":case"bottomcenter":o=1;break;case"topleft":n=-1,o=-1;break;case"topright":n=1,o=-1;break;case"bottomleft":n=-1,o=1;break;case"bottomright":n=1,o=1}return t&&(n*=t,o*=t),{x:n,y:o}};function te(e,t,n,o=!1,r=!1){var l;let a=null==(l=[...function(e,t){var n;let o=null==(n=e.reactGridRef)?void 0:n.getElementsByClassName(`rgCellContainer rgRowIdx-${t.rowIndex} rgColIdx-${t.colIndex}`);if(!o)throw Error("No cellContainer found for this cell!");if(1!==o.length)throw Error("There should be no two cells occupying the same space (simultaneously occupying X and Y)!");return o[0].closest(".rgPane")}(e,t).classList].find(e=>e.includes("rgPane-")))?void 0:l.replace("rgPane-",""),d=e9(e.reactGridRef,!0),{rowIndex:i,colIndex:s}=e.focusedLocation,c=Math.sqrt(Math.pow(i+s,2)+Math.pow(n.rowIndex+n.colIndex,2)),{x:u,y:f}=e8(a,8>c?8:c);o&&(f=0),r&&(u=0),null==d||d.scrollBy(u,f)}let tt=(e,{currentDragOverCell:t,startingPointerIdx:n,currentPointerIdx:o,shouldSelectEntireColumn:r=!0,shouldEnableRowSelection:l=!0})=>{if(!1===t.isSelectable)return e;let a=structuredClone(e.selectedArea),d=structuredClone(e.focusedLocation);if(r){a.startRowIdx=0,a.endRowIdx=e.rows.length,o.colIndex<n.colIndex?(a.startColIdx=o.colIndex,a.endColIdx=n.colIndex+1):(a.startColIdx=n.colIndex,a.endColIdx=o.colIndex+((null==t?void 0:t.colSpan)||1));for(let t=a.startColIdx;t<a.endColIdx;t++){let n=e.cells.get(`0 ${t}`);if(!n)return e;if(eq(n)){let t=e.getCellByIndexes(n.originRowIndex,n.originColIndex);if(t&&(!1===t.isSelectable||!1===t.isFocusable))return e}else if(!1===n.isSelectable||!1===n.isFocusable)return e}}else if(l){a.startColIdx=0,a.endColIdx=e.columns.length,o.rowIndex<n.rowIndex?(a.startRowIdx=o.rowIndex,a.endRowIdx=n.rowIndex+1):(a.startRowIdx=n.rowIndex,a.endRowIdx=o.rowIndex+((null==t?void 0:t.rowSpan)||1));for(let t=a.startRowIdx;t<a.endRowIdx;t++){let n=e.cells.get(`${t} 0`);if(!n)return e;if(eq(n)){let t=e.getCellByIndexes(n.originRowIndex,n.originColIndex);if(t&&(!1===t.isSelectable||!1===t.isFocusable))return e}else if(!1===n.isSelectable||!1===n.isFocusable)return e}}else o.rowIndex<d.rowIndex?(a.endRowIdx=d.rowIndex+1,a.startRowIdx=o.rowIndex):(a.endRowIdx=o.rowIndex+((null==t?void 0:t.rowSpan)||1),a.startRowIdx=d.rowIndex),o.colIndex<d.colIndex?(a.endColIdx=d.colIndex+1,a.startColIdx=o.colIndex):(a.endColIdx=o.colIndex+((null==t?void 0:t.colSpan)||1),a.startColIdx=d.colIndex);let i=eQ(e,a);return eZ(i,eJ(e,t))?{...e,selectedArea:ek}:{...e,selectedArea:i}},tn={id:"CellSelection",handlePointerMove(e,t){let n;let{clientX:o,clientY:r}=e,l=e2(o,r),a=t.getCellByIndexes(l.rowIndex,l.colIndex);if(n=eZ(t.selectedArea,ek)?e3(t,t.getFocusedCell()):e3(t,t.getCellByIndexes(t.pointerStartIdx.rowIndex,t.pointerStartIdx.colIndex)),!a||("Center"===n&&te(t,a,l),("Left"===n||"Right"===n)&&te(t,a,l,!1,!0),("TopCenter"===n||"BottomCenter"===n)&&te(t,a,l,!0),!e1(o,r)))return t;let d=0===t.pointerStartIdx.rowIndex&&!!t.enableColumnSelectionOnFirstRow,i=0===t.pointerStartIdx.colIndex&&!!t.enableRowSelectionOnFirstColumn;return tt(t,{currentDragOverCell:a,startingPointerIdx:t.pointerStartIdx,currentPointerIdx:l,shouldSelectEntireColumn:d,shouldEnableRowSelection:i})},handlePointerUp(e,t){var n;let o=t.getBehavior("Default");return null==(n=t.onAreaSelected)||n.call(t,t.selectedArea),{...t,currentBehavior:o}},handlePointerDownTouch(e,t){let n=t.getBehavior("Default");return{...t,currentBehavior:n}},handlePointerUpTouch(e,t){let n=t.getBehavior("Default");return{...t,currentBehavior:n}},handlePointerEnter:(e,t)=>t,handlePointerHold:function(e,t){return t},handlePointerHoldTouch:function(e,t){return t},handlePointerMoveTouch(e,t){let n;let{clientX:o,clientY:r}=e,l=e2(o,r),a=t.getCellByIndexes(l.rowIndex,l.colIndex);if(n=eZ(t.selectedArea,ek)?e3(t,t.getFocusedCell()):e3(t,t.getCellByIndexes(t.pointerStartIdx.rowIndex,t.pointerStartIdx.colIndex)),!a)return t;"Center"===n&&te(t,a,l),("Left"===n||"Right"===n)&&te(t,a,l,!1,!0),("TopCenter"===n||"BottomCenter"===n)&&te(t,a,l,!0);let d=!e6(t,a,t.paneRanges.Center),i=d?e0(t,a):e4(o,r);if(!i)return t;let s=0===t.pointerStartIdx.rowIndex&&!!t.enableColumnSelectionOnFirstRow,c=0===t.pointerStartIdx.colIndex&&!!t.enableRowSelectionOnFirstColumn;if(i&&d){let e=e5(i)||eT;return tt(t,{currentDragOverCell:a,startingPointerIdx:t.pointerStartIdx,currentPointerIdx:e,shouldSelectEntireColumn:s,shouldEnableRowSelection:c})}return tt(t,{currentDragOverCell:a,startingPointerIdx:t.pointerStartIdx,currentPointerIdx:l,shouldSelectEntireColumn:s,shouldEnableRowSelection:c})},handlePointerEnterTouch:(e,t)=>t};function to(e){let t=/rgRowIdx-(\d+)/.exec(e.classList.value),n=/rgColIdx-(\d+)/.exec(e.classList.value);return t&&n?{rowIndex:parseInt(t[1]),colIndex:parseInt(n[1])}:{rowIndex:-1,colIndex:-1}}function tr(e,t={},n={bubbles:!1,cancelable:!1,composed:!1}){let o=new Event(e,n);return t&&(o=Object.assign(o,{reactgrid:t})),dispatchEvent(o)}let tl=(e,t,n)=>eq(t)?e6(e,e.cells.get(`${t.originRowIndex} ${t.originColIndex}`),e.paneRanges[n]):e6(e,t,e.paneRanges[n]),ta=(e,t)=>{let n=e.paneRanges;switch(t){case"TopLeft":return n.TopLeft.endRowIdx>0;case"TopCenter":case"TopRight":return n.TopCenter.endRowIdx>0;case"Left":return n.Left.endColIdx>0;case"Right":return n.Right.startColIdx<e.columns.length;case"BottomLeft":return n.BottomLeft.startRowIdx<e.rows.length;case"BottomCenter":case"BottomRight":return n.BottomCenter.startRowIdx<e.rows.length;default:return!1}};function td(e,t){if("rowIndex"in e||"rowIndex"in t)return"rowIndex"in e&&"rowIndex"in t?e.rowIndex===t.rowIndex&&e.colIndex===t.colIndex:null;{let n=e5(e),o=e5(t);return n&&o&&n.rowIndex===o.rowIndex&&n.colIndex===o.colIndex}}let ti=(e,t,n)=>{let o=e.getCellByIndexes(t.rowIndex,t.colIndex);if(!o||!ta(e,n))return 0;let r=null;switch(n){case"Left":r=e.getCellByIndexes(t.rowIndex,e.paneRanges.Left.endColIdx-1);break;case"Right":r=e.getCellByIndexes(t.rowIndex,e.paneRanges.Right.startColIdx);break;case"TopCenter":r=e.getCellByIndexes(e.paneRanges.TopCenter.endRowIdx-1,t.colIndex);break;case"BottomCenter":r=e.getCellByIndexes(e.paneRanges.BottomCenter.startRowIdx,t.colIndex)}if(!r||tl(e,o,n)||tl(e,o,"TopRight")||tl(e,o,"BottomRight")||tl(e,o,"TopLeft")||tl(e,o,"BottomLeft"))return 0;let l=e0(e,r),a=e0(e,o);if(!l||!a||td(l,a))return 0;if("Right"===n){let e=Math.abs(l.offsetLeft-(a.offsetLeft+a.offsetWidth));return a.offsetLeft+a.offsetWidth<=l.offsetLeft?0:e}if("Left"===n){let e=Math.abs(l.offsetLeft+l.offsetWidth-a.offsetLeft);return a.offsetLeft>=l.offsetLeft+l.offsetWidth?0:e}if("BottomCenter"===n){let e=Math.abs(a.offsetTop+a.offsetHeight-l.offsetTop);return a.offsetTop+a.offsetHeight<=l.offsetTop?0:e}if("TopCenter"===n){let e=Math.abs(l.offsetTop+l.offsetHeight-a.offsetTop);return a.offsetTop>=l.offsetTop+l.offsetHeight?0:e}},ts=e=>"string"==typeof e?parseInt(e,10):e;var tc={exports:{}};tc.exports,function(e,t){var n,o,r,l,a,d,i,s,c,u,f,x="__lodash_hash_undefined__",I="[object Arguments]",p="[object Function]",h="[object Object]",g=/^\[object .+?Constructor\]$/,w=/^(?:0|[1-9]\d*)$/,C={};C["[object Float32Array]"]=C["[object Float64Array]"]=C["[object Int8Array]"]=C["[object Int16Array]"]=C["[object Int32Array]"]=C["[object Uint8Array]"]=C["[object Uint8ClampedArray]"]=C["[object Uint16Array]"]=C["[object Uint32Array]"]=!0,C[I]=C["[object Array]"]=C["[object ArrayBuffer]"]=C["[object Boolean]"]=C["[object DataView]"]=C["[object Date]"]=C["[object Error]"]=C[p]=C["[object Map]"]=C["[object Number]"]=C[h]=C["[object RegExp]"]=C["[object Set]"]=C["[object String]"]=C["[object WeakMap]"]=!1;var R="object"==typeof q&&q&&q.Object===Object&&q,v="object"==typeof self&&self&&self.Object===Object&&self,y=R||v||Function("return this")(),m=t&&!t.nodeType&&t,b=m&&e&&!e.nodeType&&e,S=b&&b.exports===m,A=S&&R.process,_=function(){try{return b&&b.require&&b.require("util").types||A&&A.binding&&A.binding("util")}catch{}}(),L=_&&_.isTypedArray,B=Array.prototype,j=Function.prototype,k=Object.prototype,T=y["__core-js_shared__"],$=j.toString,P=k.hasOwnProperty,O=(i=/[^.]+$/.exec(T&&T.keys&&T.keys.IE_PROTO||""))?"Symbol(src)_1."+i:"",E=k.toString,F=$.call(Object),D=RegExp("^"+$.call(P).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),M=S?y.Buffer:void 0,z=y.Symbol,H=y.Uint8Array,N=M?M.allocUnsafe:void 0,V=(s=Object.getPrototypeOf,c=Object,function(e){return s(c(e))}),U=Object.create,G=k.propertyIsEnumerable,W=B.splice,X=z?z.toStringTag:void 0,Z=function(){try{var e=ex(Object,"defineProperty");return e({},"",{}),e}catch{}}(),Y=M?M.isBuffer:void 0,K=Math.max,J=Date.now,Q=ex(y,"Map"),ee=ex(Object,"create"),et=function(){function e(){}return function(t){if(!eS(t))return{};if(U)return U(t);e.prototype=t;var n=new e;return e.prototype=void 0,n}}();function en(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var o=e[t];this.set(o[0],o[1])}}function eo(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var o=e[t];this.set(o[0],o[1])}}function er(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var o=e[t];this.set(o[0],o[1])}}function el(e){var t=this.__data__=new eo(e);this.size=t.size}function ea(e,t,n){(void 0===n||ew(e[t],n))&&(void 0!==n||t in e)||ei(e,t,n)}function ed(e,t){for(var n=e.length;n--;)if(ew(e[n][0],t))return n;return -1}function ei(e,t,n){"__proto__"==t&&Z?Z(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n}en.prototype.clear=function(){this.__data__=ee?ee(null):{},this.size=0},en.prototype.delete=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},en.prototype.get=function(e){var t=this.__data__;if(ee){var n=t[e];return n===x?void 0:n}return P.call(t,e)?t[e]:void 0},en.prototype.has=function(e){var t=this.__data__;return ee?void 0!==t[e]:P.call(t,e)},en.prototype.set=function(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=ee&&void 0===t?x:t,this},eo.prototype.clear=function(){this.__data__=[],this.size=0},eo.prototype.delete=function(e){var t=this.__data__,n=ed(t,e);return!(n<0)&&(n==t.length-1?t.pop():W.call(t,n,1),--this.size,!0)},eo.prototype.get=function(e){var t=this.__data__,n=ed(t,e);return n<0?void 0:t[n][1]},eo.prototype.has=function(e){return ed(this.__data__,e)>-1},eo.prototype.set=function(e,t){var n=this.__data__,o=ed(n,e);return o<0?(++this.size,n.push([e,t])):n[o][1]=t,this},er.prototype.clear=function(){this.size=0,this.__data__={hash:new en,map:new(Q||eo),string:new en}},er.prototype.delete=function(e){var t=ef(this,e).delete(e);return this.size-=t?1:0,t},er.prototype.get=function(e){return ef(this,e).get(e)},er.prototype.has=function(e){return ef(this,e).has(e)},er.prototype.set=function(e,t){var n=ef(this,e),o=n.size;return n.set(e,t),this.size+=n.size==o?0:1,this},el.prototype.clear=function(){this.__data__=new eo,this.size=0},el.prototype.delete=function(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n},el.prototype.get=function(e){return this.__data__.get(e)},el.prototype.has=function(e){return this.__data__.has(e)},el.prototype.set=function(e,t){var n=this.__data__;if(n instanceof eo){var o=n.__data__;if(!Q||o.length<199)return o.push([e,t]),this.size=++n.size,this;n=this.__data__=new er(o)}return n.set(e,t),this.size=n.size,this};var es=function(e,t,n){for(var o=-1,r=Object(e),l=n(e),a=l.length;a--;){var d=l[++o];if(!1===t(r[d],d,r))break}return e};function ec(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":X&&X in Object(e)?function(e){var t=P.call(e,X),n=e[X];try{e[X]=void 0;var o=!0}catch{}var r=E.call(e);return o&&(t?e[X]=n:delete e[X]),r}(e):E.call(e)}function eu(e){return eA(e)&&ec(e)==I}function ef(e,t){var n,o=e.__data__;return("string"==(n=typeof t)||"number"==n||"symbol"==n||"boolean"==n?"__proto__"!==t:null===t)?o["string"==typeof t?"string":"hash"]:o.map}function ex(e,t){var n=null==e?void 0:e[t];return!(!eS(n)||O&&O in n)&&(em(n)?D:g).test(function(e){if(null!=e){try{return $.call(e)}catch{}try{return e+""}catch{}}return""}(n))?n:void 0}function eI(e,t){var n=typeof e;return!!(t=t??9007199254740991)&&("number"==n||"symbol"!=n&&w.test(e))&&e>-1&&e%1==0&&e<t}function ep(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||k)}function eh(e,t){if(!("constructor"===t&&"function"==typeof e[t])&&"__proto__"!=t)return e[t]}var eg=(n=Z?function(e,t){return Z(e,"toString",{configurable:!0,enumerable:!1,value:function(){return t},writable:!0})}:ej,o=0,r=0,function(){var e=J(),t=16-(e-r);if(r=e,t>0){if(++o>=800)return arguments[0]}else o=0;return n.apply(void 0,arguments)});function ew(e,t){return e===t||e!=e&&t!=t}var eC=eu(function(){return arguments}())?eu:function(e){return eA(e)&&P.call(e,"callee")&&!G.call(e,"callee")},eR=Array.isArray;function ev(e){return null!=e&&eb(e.length)&&!em(e)}var ey=Y||function(){return!1};function em(e){if(!eS(e))return!1;var t=ec(e);return t==p||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t}function eb(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991}function eS(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}function eA(e){return null!=e&&"object"==typeof e}var e_=L?function(e){return L(e)}:function(e){return eA(e)&&eb(e.length)&&!!C[ec(e)]};function eL(e){return ev(e)?function(e,t){var n=eR(e),o=!n&&eC(e),r=!n&&!o&&ey(e),l=!n&&!o&&!r&&e_(e),a=n||o||r||l,d=a?function(e,t){for(var n=-1,o=Array(e);++n<e;)o[n]=t(n);return o}(e.length,String):[],i=d.length;for(var s in e)(t||P.call(e,s))&&!(a&&("length"==s||r&&("offset"==s||"parent"==s)||l&&("buffer"==s||"byteLength"==s||"byteOffset"==s)||eI(s,i)))&&d.push(s);return d}(e,!0):function(e){if(!eS(e))return function(e){var t=[];if(null!=e)for(var n in Object(e))t.push(n);return t}(e);var t=ep(e),n=[];for(var o in e)"constructor"==o&&(t||!P.call(e,o))||n.push(o);return n}(e)}var eB=(u=function(e,t,n){!function e(t,n,o,r,l){t!==n&&es(n,function(a,d){if(l||(l=new el),eS(a))(function(e,t,n,o,r,l,a){var d=eh(e,n),i=eh(t,n),s=a.get(i);if(s){ea(e,n,s);return}var c=l?l(d,i,n+"",e,t,a):void 0,u=void 0===c;if(u){var f,x,I,p=eR(i),g=!p&&ey(i),w=!p&&!g&&e_(i);c=i,p||g||w?eR(d)?c=d:eA(d)&&ev(d)?c=function(e,t){var n=-1,o=e.length;for(t||(t=Array(o));++n<o;)t[n]=e[n];return t}(d):g?(u=!1,c=function(e,t){if(t)return e.slice();var n=e.length,o=N?N(n):new e.constructor(n);return e.copy(o),o}(i,!0)):w?(u=!1,new H(x=new(f=i.buffer).constructor(f.byteLength)).set(new H(f)),I=x,c=new i.constructor(I,i.byteOffset,i.length)):c=[]:function(e){if(!eA(e)||ec(e)!=h)return!1;var t=V(e);if(null===t)return!0;var n=P.call(t,"constructor")&&t.constructor;return"function"==typeof n&&n instanceof n&&$.call(n)==F}(i)||eC(i)?(c=d,eC(d)?c=function(e,t,n,o){var r=!n;n||(n={});for(var l=-1,a=t.length;++l<a;){var d=t[l],i=void 0;void 0===i&&(i=e[d]),r?ei(n,d,i):function(e,t,n){var o=e[t];P.call(e,t)&&ew(o,n)&&(void 0!==n||t in e)||ei(e,t,n)}(n,d,i)}return n}(d,eL(d)):(!eS(d)||em(d))&&(c="function"!=typeof i.constructor||ep(i)?{}:et(V(i)))):u=!1}u&&(a.set(i,c),r(c,i,o,l,a),a.delete(i)),ea(e,n,c)})(t,n,d,o,e,r,l);else{var i=r?r(eh(t,d),a,d+"",t,n,l):void 0;void 0===i&&(i=a),ea(t,d,i)}},eL)}(e,t,n)},eg((l=f=function(e,t){var n=-1,o=t.length,r=o>1?t[o-1]:void 0,l=o>2?t[2]:void 0;for(r=u.length>3&&"function"==typeof r?(o--,r):void 0,l&&function(e,t,n){if(!eS(n))return!1;var o=typeof t;return("number"==o?!!(ev(n)&&eI(t,n.length)):"string"==o&&(t in n))&&ew(n[t],e)}(t[0],t[1],l)&&(r=o<3?void 0:r,o=1),e=Object(e);++n<o;){var a=t[n];a&&u(e,a,n,r)}return e},a=void 0,d=ej,a=K(void 0===a?l.length-1:a,0),function(){for(var e=arguments,t=-1,n=K(e.length-a,0),o=Array(n);++t<n;)o[t]=e[a+t];t=-1;for(var r=Array(a+1);++t<a;)r[t]=e[t];return r[a]=d(o),function(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}(l,this,r)}),f+""));function ej(e){return e}e.exports=eB}(tc,tc.exports);let tu=K(tc.exports),tf={gap:{width:"1px",color:"rgb(230 230 230)"},paneContainer:{top:{},right:{},bottom:{},left:{}},cellContainer:{padding:{top:"2px",right:"2px",bottom:"2px",left:"2px"},background:"white"},area:{border:{color:"lightblue",style:"solid",width:"2px"}},focusIndicator:{background:"transparent",border:{color:"#3bb6df",style:"solid",width:"2px"}},fillHandle:{background:"transparent",border:{color:"black",style:"dashed",width:"2px"}},line:{backgroundColor:"lightblue",size:"3px"},shadow:{backgroundColor:"#E5E5E5AF"},resizeColumn:{default:{position:"absolute",top:0,right:0,background:"transparent",width:"5px",height:"100%"},hover:{backgroundColor:"lightblue"}},selectionIndicator:{background:"#add8e630",border:{color:"lightblue",style:"solid",width:"2px"}}};var tx={exports:{}};tx.exports,function(e,t){var n,o="__lodash_hash_undefined__",r="[object Arguments]",l="[object Boolean]",a="[object Date]",d="[object Function]",i="[object GeneratorFunction]",s="[object Map]",c="[object Number]",u="[object Object]",f="[object Promise]",x="[object RegExp]",I="[object Set]",p="[object String]",h="[object Symbol]",g="[object WeakMap]",w="[object ArrayBuffer]",C="[object DataView]",R="[object Float32Array]",v="[object Float64Array]",y="[object Int8Array]",m="[object Int16Array]",b="[object Int32Array]",S="[object Uint8Array]",A="[object Uint8ClampedArray]",_="[object Uint16Array]",L="[object Uint32Array]",B=/\w*$/,j=/^\[object .+?Constructor\]$/,k=/^(?:0|[1-9]\d*)$/,T={};T[r]=T["[object Array]"]=T[w]=T[C]=T[l]=T[a]=T[R]=T[v]=T[y]=T[m]=T[b]=T[s]=T[c]=T[u]=T[x]=T[I]=T[p]=T[h]=T[S]=T[A]=T[_]=T[L]=!0,T["[object Error]"]=T[d]=T[g]=!1;var $="object"==typeof q&&q&&q.Object===Object&&q,P="object"==typeof self&&self&&self.Object===Object&&self,O=$||P||Function("return this")(),E=t&&!t.nodeType&&t,F=E&&e&&!e.nodeType&&e,D=F&&F.exports===E;function M(e,t){return e.set(t[0],t[1]),e}function z(e,t){return e.add(t),e}function H(e,t,n,o){var r=-1,l=e?e.length:0;for(o&&l&&(n=e[++r]);++r<l;)n=t(n,e[r],r,e);return n}function N(e){var t=!1;if(null!=e&&"function"!=typeof e.toString)try{t=!!(e+"")}catch{}return t}function V(e){var t=-1,n=Array(e.size);return e.forEach(function(e,o){n[++t]=[o,e]}),n}function U(e,t){return function(n){return e(t(n))}}function G(e){var t=-1,n=Array(e.size);return e.forEach(function(e){n[++t]=e}),n}var W=Array.prototype,X=Function.prototype,Z=Object.prototype,Y=O["__core-js_shared__"],K=(n=/[^.]+$/.exec(Y&&Y.keys&&Y.keys.IE_PROTO||""))?"Symbol(src)_1."+n:"",J=X.toString,Q=Z.hasOwnProperty,ee=Z.toString,et=RegExp("^"+J.call(Q).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),en=D?O.Buffer:void 0,eo=O.Symbol,er=O.Uint8Array,el=U(Object.getPrototypeOf,Object),ea=Object.create,ed=Z.propertyIsEnumerable,ei=W.splice,es=Object.getOwnPropertySymbols,ec=en?en.isBuffer:void 0,eu=U(Object.keys,Object),ef=eP(O,"DataView"),ex=eP(O,"Map"),eI=eP(O,"Promise"),ep=eP(O,"Set"),eh=eP(O,"WeakMap"),eg=eP(Object,"create"),ew=eD(ef),eC=eD(ex),eR=eD(eI),ev=eD(ep),ey=eD(eh),em=eo?eo.prototype:void 0,eb=em?em.valueOf:void 0;function eS(e){var t=-1,n=e?e.length:0;for(this.clear();++t<n;){var o=e[t];this.set(o[0],o[1])}}function eA(e){var t=-1,n=e?e.length:0;for(this.clear();++t<n;){var o=e[t];this.set(o[0],o[1])}}function e_(e){var t=-1,n=e?e.length:0;for(this.clear();++t<n;){var o=e[t];this.set(o[0],o[1])}}function eL(e){this.__data__=new eA(e)}function eB(e,t,n){var o=e[t];Q.call(e,t)&&eM(o,n)&&(void 0!==n||t in e)||(e[t]=n)}function ej(e,t){for(var n=e.length;n--;)if(eM(e[n][0],t))return n;return -1}function ek(e){var t=new e.constructor(e.byteLength);return new er(t).set(new er(e)),t}function eT(e,t,n,o){n||(n={});for(var r=-1,l=t.length;++r<l;){var a=t[r],d=o?o(n[a],e[a],a,n,e):void 0;eB(n,a,void 0===d?e[a]:d)}return n}function e$(e,t){var n,o=e.__data__;return("string"==(n=typeof t)||"number"==n||"symbol"==n||"boolean"==n?"__proto__"!==t:null===t)?o["string"==typeof t?"string":"hash"]:o.map}function eP(e,t){var n=null==e?void 0:e[t];return!(!eU(n)||K&&K in n)&&(eV(n)||N(n)?et:j).test(eD(n))?n:void 0}eS.prototype.clear=function(){this.__data__=eg?eg(null):{}},eS.prototype.delete=function(e){return this.has(e)&&delete this.__data__[e]},eS.prototype.get=function(e){var t=this.__data__;if(eg){var n=t[e];return n===o?void 0:n}return Q.call(t,e)?t[e]:void 0},eS.prototype.has=function(e){var t=this.__data__;return eg?void 0!==t[e]:Q.call(t,e)},eS.prototype.set=function(e,t){return this.__data__[e]=eg&&void 0===t?o:t,this},eA.prototype.clear=function(){this.__data__=[]},eA.prototype.delete=function(e){var t=this.__data__,n=ej(t,e);return!(n<0)&&(n==t.length-1?t.pop():ei.call(t,n,1),!0)},eA.prototype.get=function(e){var t=this.__data__,n=ej(t,e);return n<0?void 0:t[n][1]},eA.prototype.has=function(e){return ej(this.__data__,e)>-1},eA.prototype.set=function(e,t){var n=this.__data__,o=ej(n,e);return o<0?n.push([e,t]):n[o][1]=t,this},e_.prototype.clear=function(){this.__data__={hash:new eS,map:new(ex||eA),string:new eS}},e_.prototype.delete=function(e){return e$(this,e).delete(e)},e_.prototype.get=function(e){return e$(this,e).get(e)},e_.prototype.has=function(e){return e$(this,e).has(e)},e_.prototype.set=function(e,t){return e$(this,e).set(e,t),this},eL.prototype.clear=function(){this.__data__=new eA},eL.prototype.delete=function(e){return this.__data__.delete(e)},eL.prototype.get=function(e){return this.__data__.get(e)},eL.prototype.has=function(e){return this.__data__.has(e)},eL.prototype.set=function(e,t){var n=this.__data__;if(n instanceof eA){var o=n.__data__;if(!ex||o.length<199)return o.push([e,t]),this;n=this.__data__=new e_(o)}return n.set(e,t),this};var eO=es?U(es,Object):function(){return[]},eE=function(e){return ee.call(e)};function eF(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||Z)}function eD(e){if(null!=e){try{return J.call(e)}catch{}try{return e+""}catch{}}return""}function eM(e,t){return e===t||e!=e&&t!=t}(ef&&eE(new ef(new ArrayBuffer(1)))!=C||ex&&eE(new ex)!=s||eI&&eE(eI.resolve())!=f||ep&&eE(new ep)!=I||eh&&eE(new eh)!=g)&&(eE=function(e){var t=ee.call(e),n=t==u?e.constructor:void 0,o=n?eD(n):void 0;if(o)switch(o){case ew:return C;case eC:return s;case eR:return f;case ev:return I;case ey:return g}return t});var ez=Array.isArray;function eH(e){var t;return null!=e&&"number"==typeof(t=e.length)&&t>-1&&t%1==0&&t<=9007199254740991&&!eV(e)}var eN=ec||function(){return!1};function eV(e){var t=eU(e)?ee.call(e):"";return t==d||t==i}function eU(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function eG(e){return eH(e)?function(e,t){var n,o=ez(e)||e&&"object"==typeof e&&eH(e)&&Q.call(e,"callee")&&(!ed.call(e,"callee")||ee.call(e)==r)?function(e,t){for(var n=-1,o=Array(e);++n<e;)o[n]=t(n);return o}(e.length,String):[],l=o.length,a=!!l;for(var d in e)Q.call(e,d)&&!(a&&("length"==d||(n=(n=l)??9007199254740991)&&("number"==typeof d||k.test(d))&&d>-1&&d%1==0&&d<n))&&o.push(d);return o}(e):function(e){if(!eF(e))return eu(e);var t=[];for(var n in Object(e))Q.call(e,n)&&"constructor"!=n&&t.push(n);return t}(e)}e.exports=function(e){return function e(t,n,o,f,g,j,k){if(f&&($=j?f(t,g,j,k):f(t)),void 0!==$)return $;if(!eU(t))return t;var $,P=ez(t);if(P){if(O=t.length,E=t.constructor(O),O&&"string"==typeof t[0]&&Q.call(t,"index")&&(E.index=t.index,E.input=t.input),$=E,!n)return function(e,t){var n=-1,o=e.length;for(t||(t=Array(o));++n<o;)t[n]=e[n];return t}(t,$)}else{var O,E,F,D,U,W,X=eE(t),Z=X==d||X==i;if(eN(t))return function(e,t){if(t)return e.slice();var n=new e.constructor(e.length);return e.copy(n),n}(t,n);if(X==u||X==r||Z&&!j){if(N(t))return j?t:{};if($="function"!=typeof(F=Z?{}:t).constructor||eF(F)?{}:eU(D=el(F))?ea(D):{},!n)return U=(W=$)&&eT(t,eG(t),W),eT(t,eO(t),U)}else{if(!T[X])return j?t:{};$=function(e,t,n,o){var r,d,i,u=e.constructor;switch(t){case w:return ek(e);case l:case a:return new u(+e);case C:return r=o?ek(e.buffer):e.buffer,new e.constructor(r,e.byteOffset,e.byteLength);case R:case v:case y:case m:case b:case S:case A:case _:case L:return d=o?ek(e.buffer):e.buffer,new e.constructor(d,e.byteOffset,e.length);case s:return H(o?n(V(e),!0):V(e),M,new e.constructor);case c:case p:return new u(e);case x:return(i=new e.constructor(e.source,B.exec(e))).lastIndex=e.lastIndex,i;case I:return H(o?n(G(e),!0):G(e),z,new e.constructor);case h:return eb?Object(eb.call(e)):{}}}(t,X,e,n)}}k||(k=new eL);var Y=k.get(t);if(Y)return Y;if(k.set(t,$),!P){var q,K,J=o?(K=eG(q=t),ez(q)?K:function(e,t){for(var n=-1,o=t.length,r=e.length;++n<o;)e[r+n]=t[n];return e}(K,eO(q))):eG(t)}return function(e,t){for(var n=-1,o=e?e.length:0;++n<o&&!1!==t(e[n],n,e););}(J||t,function(r,l){J&&(r=t[l=r]),eB($,l,e(r,n,o,f,l,t,k))}),$}(e,!0,!0)}}(tx,tx.exports);let tI=K(tx.exports),tp=e=>tu(tI(tf),e.styles),th=(e,t,n,o)=>{let r=ts(tp(e).gap.width||0),l=ti(e,{rowIndex:t,colIndex:n},"BottomCenter"),a=ti(e,{rowIndex:t,colIndex:n},"TopCenter"),d=ti(e,{rowIndex:t,colIndex:n},"Left"),i=ti(e,{rowIndex:t,colIndex:n},"Right");a&&(null==o||o.scrollBy({top:-a-r})),i&&(null==o||o.scrollBy({left:i+r})),l&&(null==o||o.scrollBy({top:l+r})),d&&(null==o||o.scrollBy({left:-d-r}))},tg=(e,t)=>{let n=`rgHiddenFocusTarget rgFocusRowIdx-${e} rgFocusColIdx-${t}`,o=document.getElementsByClassName(n);if(o.length>0)return o[0]},tw=(e,t)=>{var n,o;if(0===t.rowIndex)return null==(n=tg(t.rowIndex,t.colIndex))||n.focus(),e;let r=e0(e,t);if(!r)return e;let l=e9(r,!0)??e.reactGridRef,a="colSpan"in t&&-1!==e.focusedLocation.colIndex?e.focusedLocation.colIndex:t.colIndex;for(let n=t.rowIndex-1;n>=0;n--){let r=e.getCellByIndexes(n,a);if(r&&(null==r?void 0:r.isFocusable)!==!1){let d=eK(e,r);return tr("focuschange",{currentFocus:t}),th(e,n,a,l),null==(o=tg(d.rowIndex,d.colIndex))||o.focus(),{selectedArea:ek}}}return e},tC=(e,t)=>{var n,o;if(t.colIndex===e.columns.length-1)return null==(n=tg(t.rowIndex,t.colIndex))||n.focus(),e;let r=e0(e,t);if(!r)return e;let l=e9(r,!0)??e.reactGridRef,a="rowSpan"in t&&-1!==e.focusedLocation.rowIndex?e.focusedLocation.rowIndex:t.rowIndex;for(let n=t.colIndex+(t.colSpan??1);n<e.columns.length;n++){let r=e.getCellByIndexes(a,n);if(r&&(null==r?void 0:r.isFocusable)!==!1){let d=eK(e,r);return tr("focuschange",{currentFocus:t}),th(e,a,n,l),null==(o=tg(d.rowIndex,d.colIndex))||o.focus(),{selectedArea:ek}}}return e},tR=(e,t)=>{var n,o,r;if(t.rowIndex===e.rows.length-1)return null==(n=tg(t.rowIndex,t.colIndex))||n.focus(),e;if(eJ(e,t).endRowIdx===e.rows.length)return null==(o=tg(t.rowIndex,t.colIndex))||o.focus(),e;let l=e0(e,t);if(!l)return e;let a=e9(l,!0)??e.reactGridRef,d="colSpan"in t&&-1!==e.focusedLocation.colIndex?e.focusedLocation.colIndex:t.colIndex;for(let n=t.rowIndex+(t.rowSpan??1);n<e.rows.length;n++){let o=e.getCellByIndexes(n,d);if(o&&(null==o?void 0:o.isFocusable)!==!1){let l=eK(e,o);return tr("focuschange",{currentFocus:t}),th(e,n,d,a),null==(r=tg(l.rowIndex,l.colIndex))||r.focus(),{selectedArea:ek}}}return e},tv=(e,t)=>{var n,o;if(0===t.colIndex)return null==(n=tg(t.rowIndex,t.colIndex))||n.focus(),e;let r=e0(e,t);if(!r)return e;let l=e9(r,!0)??e.reactGridRef,a="rowSpan"in t&&-1!==e.focusedLocation.rowIndex?e.focusedLocation.rowIndex:t.rowIndex;for(let n=t.colIndex-1;n>=0;n--){let r=e.getCellByIndexes(a,n);if(r&&(null==r?void 0:r.isFocusable)!==!1){let d=eK(e,r);return tr("focuschange",{currentFocus:t}),th(e,a,n,l),null==(o=tg(d.rowIndex,d.colIndex))||o.focus(),{selectedArea:ek}}}return e},ty=(e,t,n)=>{var o,r,l,a,d;switch(n){case"right":{let n=t.colIndex,r=t.rowIndex,l=e.getCellOrSpanMemberByIndexes(r,n);do++n===e.selectedArea.endColIdx&&(n=e.selectedArea.startColIdx,++r===e.selectedArea.endRowIdx&&(r=e.selectedArea.startRowIdx)),l=e.getCellOrSpanMemberByIndexes(r,n);while(!l||eq(l)||(null==l?void 0:l.isFocusable)===!1);return null==(o=tg(r,n))||o.focus(),e}case"left":{let n=t.colIndex,o=t.rowIndex,l=e.getCellOrSpanMemberByIndexes(o,n);do--n==e.selectedArea.startColIdx-1&&(n=e.selectedArea.endColIdx-1,--o==e.selectedArea.startRowIdx-1&&(o=e.selectedArea.endRowIdx-1)),l=e.getCellOrSpanMemberByIndexes(o,n);while(!l||eq(l)||(null==l?void 0:l.isFocusable)===!1);return null==(r=tg(o,n))||r.focus(),e}case"down":{let n=t.colIndex,o=t.rowIndex,r=e.getCellOrSpanMemberByIndexes(o,n);do++o===e.selectedArea.endRowIdx&&(o=e.selectedArea.startRowIdx,++n===e.selectedArea.endColIdx&&(n=e.selectedArea.startColIdx)),r=e.getCellOrSpanMemberByIndexes(o,n);while(!r||eq(r)||(null==r?void 0:r.isFocusable)===!1);return null==(l=tg(o,n))||l.focus(),e}case"up":{let n=t.colIndex,o=t.rowIndex,r=e.getCellOrSpanMemberByIndexes(o,n);if(0===o)return null==(a=tg(o,n))||a.focus(),e;do--o==e.selectedArea.startRowIdx-1&&(o=e.selectedArea.endRowIdx-1,--n==e.selectedArea.startColIdx-1&&(n=e.selectedArea.endColIdx-1)),r=e.getCellOrSpanMemberByIndexes(o,n);while(!r||eq(r)||(null==r?void 0:r.isFocusable)===!1);return tr("focuschange",{currentFocus:t}),null==(d=tg(o,n))||d.focus(),e}}},tm=(e,t,n,o=1)=>{let r=eJ(e,t),l=ej(e.selectedArea,ek)?{...r}:{...e.selectedArea};switch(n){case"Left":l.endColIdx>r.endColIdx?(l.endColIdx-=o,e6(e,t,l)||(l.endColIdx+=o,o=1,l.startColIdx-=o)):l.startColIdx-=o;break;case"Right":l.startColIdx<t.colIndex?(l.startColIdx+=o,e6(e,t,l)||(l.startColIdx-=o,o=1,l.endColIdx+=o)):l.endColIdx+=o;break;case"Up":l.endRowIdx>r.endRowIdx?(l.endRowIdx-=o,e6(e,t,l)||(l.endRowIdx+=o,o=1,l.startRowIdx-=o)):l.startRowIdx-=o;break;case"Down":l.startRowIdx<t.rowIndex?(l.startRowIdx+=o,e6(e,t,l)||(l.startRowIdx-=o,o=1,l.endRowIdx+=o)):l.endRowIdx+=o}let{columns:a,rows:d}=e,{startColIdx:i,endColIdx:s,startRowIdx:c,endRowIdx:u}=l;if(i<0||s<0||c<0||u<0||s>a.length||c>d.length||u>d.length||i>a.length)return e;if(ej(l,r))return{...e,selectedArea:ek};let f=eQ(e,l);return ej(f,e.selectedArea)?tm(e,t,n,o+1):{...e,selectedArea:{...f}}},tb=(e,t)=>{let n=e.reactGridRef,o=0;if(void 0===t)return 0;for(let r of e.getColumnCells(t)){let t=e0(e,r);t&&function(e,t){let{top:n,bottom:o,left:r,right:l}=e.getBoundingClientRect();return n>=0&&r>=0&&o<=(window.innerHeight||t.clientHeight)&&l<=(window.innerWidth||t.clientWidth)}(t,n)&&(e6(e,r,e.paneRanges.Left)||e6(e,r,e.paneRanges.Center)||e6(e,r,e.paneRanges.Right))&&o++}return o},tS=(e,t,n)=>{switch(n){case"Left":let o,r,l;return o=e.paneRanges.TopLeft,t.startRowIdx>=o.startRowIdx&&t.endRowIdx<=o.endRowIdx&&t.startColIdx>=o.startColIdx&&t.endColIdx<=o.endColIdx||(r=e.paneRanges.Left,t.startRowIdx>=r.startRowIdx&&t.endRowIdx<=r.endRowIdx&&t.startColIdx>=r.startColIdx&&t.endColIdx<=r.endColIdx)||(l=e.paneRanges.BottomLeft,t.startRowIdx>=l.startRowIdx&&t.endRowIdx<=l.endRowIdx&&t.startColIdx>=l.startColIdx&&t.endColIdx<=l.endColIdx);case"Right":let a,d,i;return a=e.paneRanges.TopRight,t.startRowIdx>=a.startRowIdx&&t.endRowIdx<=a.endRowIdx&&t.startColIdx>=a.startColIdx&&t.endColIdx<=a.endColIdx||(d=e.paneRanges.Right,t.startRowIdx>=d.startRowIdx&&t.endRowIdx<=d.endRowIdx&&t.startColIdx>=d.startColIdx&&t.endColIdx<=d.endColIdx)||(i=e.paneRanges.BottomRight,t.startRowIdx>=i.startRowIdx&&t.endRowIdx<=i.endRowIdx&&t.startColIdx>=i.startColIdx&&t.endColIdx<=i.endColIdx);case"Top":let s,c,u;return s=e.paneRanges.TopLeft,t.startRowIdx>=s.startRowIdx&&t.endRowIdx<=s.endRowIdx&&t.startColIdx>=s.startColIdx&&t.endColIdx<=s.endColIdx||(c=e.paneRanges.TopCenter,t.startRowIdx>=c.startRowIdx&&t.endRowIdx<=c.endRowIdx&&t.startColIdx>=c.startColIdx&&t.endColIdx<=c.endColIdx)||(u=e.paneRanges.TopRight,t.startRowIdx>=u.startRowIdx&&t.endRowIdx<=u.endRowIdx&&t.startColIdx>=u.startColIdx&&t.endColIdx<=u.endColIdx);case"Bottom":let f,x,I;return f=e.paneRanges.BottomLeft,t.startRowIdx>=f.startRowIdx&&t.endRowIdx<=f.endRowIdx&&t.startColIdx>=f.startColIdx&&t.endColIdx<=f.endColIdx||(x=e.paneRanges.BottomCenter,t.startRowIdx>=x.startRowIdx&&t.endRowIdx<=x.endRowIdx&&t.startColIdx>=x.startColIdx&&t.endColIdx<=x.endColIdx)||(I=e.paneRanges.BottomRight,t.startRowIdx>=I.startRowIdx&&t.endRowIdx<=I.endRowIdx&&t.startColIdx>=I.startColIdx&&t.endColIdx<=I.endColIdx);default:return!1}},tA={moveHorizontallyOnEnter:!1},t_=(e,t,n=tA)=>{var o,r,l,a,d,i,s,c,u,f;let x=t.getFocusedCell();if(!x){let e=t.getCellByIndexes(0,0);if(!e)return t;x={...e}}let I=!ej(t.selectedArea,ek)&&e6(t,x,t.selectedArea);if(e.shiftKey&&(e.ctrlKey||e.metaKey))switch(e.key){case"Home":{e.preventDefault();let n=eJ(t,x);return{...t,selectedArea:{startRowIdx:0,endRowIdx:n.endRowIdx,startColIdx:n.startColIdx,endColIdx:n.endColIdx}}}case"End":{e.preventDefault();let n=eJ(t,x);return{...t,selectedArea:{startRowIdx:n.startRowIdx,endRowIdx:t.rows.length,startColIdx:n.startColIdx,endColIdx:n.endColIdx}}}case"ArrowUp":{e.preventDefault();let n={...t.selectedArea};ej(n,ek)&&(n=eJ(t,x));let o=eQ(t,{...n,startRowIdx:0});return{...t,selectedArea:{...o}}}case"ArrowDown":{e.preventDefault();let n={...t.selectedArea};ej(n,ek)&&(n=eJ(t,x));let o=eQ(t,{...n,endRowIdx:t.rows.length});return{...t,selectedArea:{...o}}}case"ArrowLeft":{e.preventDefault();let n={...t.selectedArea};ej(n,ek)&&(n=eJ(t,x));let o=eQ(t,{...n,startColIdx:0});return{...t,selectedArea:{...o}}}case"ArrowRight":{e.preventDefault();let n={...t.selectedArea};ej(n,ek)&&(n=eJ(t,x));let o=eQ(t,{...n,endColIdx:t.columns.length});return{...t,selectedArea:{...o}}}default:return t}if(e.ctrlKey||e.metaKey)switch(e.key){case"a":{e.preventDefault();let n={startRowIdx:0,endRowIdx:t.rows.length,startColIdx:0,endColIdx:t.columns.length};return ej(t.selectedArea,n)?{...t,selectedArea:ek}:{...t,selectedArea:n}}case"Home":return e.preventDefault(),null==(o=tg(0,0))||o.focus({preventScroll:!0}),t;case"End":return e.preventDefault(),null==(r=tg(t.rows.length-1,t.columns.length-1))||r.focus({preventScroll:!0}),t;case"ArrowUp":return e.preventDefault(),x?(null==(l=tg(0,t.focusedLocation.colIndex))||l.focus({preventScroll:!0}),{selectedArea:ek}):t;case"ArrowDown":return e.preventDefault(),x?(null==(a=tg(t.rows.length-1,t.focusedLocation.colIndex))||a.focus({preventScroll:!0}),{selectedArea:ek}):t;case"ArrowLeft":return e.preventDefault(),x?(null==(d=tg(t.focusedLocation.rowIndex,0))||d.focus({preventScroll:!0}),{selectedArea:ek}):t;case"ArrowRight":return e.preventDefault(),x?(null==(i=tg(t.focusedLocation.rowIndex,t.columns.length-1))||i.focus({preventScroll:!0}),{selectedArea:ek}):t;case" ":{e.preventDefault();let n={...t.selectedArea};ej(n,ek)&&(n=eJ(t,x));let o=eQ(t,{...n,startRowIdx:0,endRowIdx:t.rows.length});return{...t,selectedArea:{...o}}}default:return t}if(e.shiftKey)switch(e.key){case"ArrowUp":return e.preventDefault(),tm(t,x,"Up");case"ArrowDown":return e.preventDefault(),tm(t,x,"Down");case"ArrowLeft":return e.preventDefault(),tm(t,x,"Left");case"ArrowRight":return e.preventDefault(),tm(t,x,"Right");case"PageUp":{e.preventDefault();let n={...t.selectedArea},o=tb(t,x.colIndex);ej(n,ek)&&(n=eJ(t,x));let r=-1,l=-1;return 0===n.startRowIdx?t:((r=n.startRowIdx-o)<0&&(r=0),l=tS(t,n,"Top")?r:tS(t,n,"Bottom")?n.startRowIdx===t.paneRanges.BottomCenter.startRowIdx?r:t.paneRanges.BottomCenter.startRowIdx:n.startRowIdx===t.paneRanges.TopCenter.endRowIdx?0:n.startRowIdx-o<=t.paneRanges.TopCenter.endRowIdx?t.paneRanges.TopCenter.endRowIdx:n.startRowIdx-o,{selectedArea:{...eQ(t,{...n,startRowIdx:l})}})}case"PageDown":{e.preventDefault();let n={...t.selectedArea},o=tb(t,x.colIndex);ej(n,ek)&&(n=eJ(t,x));let r=-1,l=-1,a=t.rows.length,d=null==(s=t.getCellByIndexes(a-1,x.colIndex))?void 0:s.rowSpan;return n.endRowIdx===a?t:(r=n.endRowIdx+o,n.endRowIdx+o>a&&(r=a-(d?d-1:0)),l=tS(t,n,"Top")?n.endRowIdx===t.paneRanges.TopCenter.endRowIdx?r:t.paneRanges.TopCenter.endRowIdx:tS(t,n,"Bottom")?r+1:n.endRowIdx===t.paneRanges.BottomCenter.startRowIdx?a-(d?d-1:0):n.endRowIdx+o>=t.paneRanges.BottomCenter.startRowIdx?t.paneRanges.BottomCenter.startRowIdx:n.endRowIdx+o,{selectedArea:{...eQ(t,{...n,endRowIdx:l})}})}case"Home":{e.preventDefault();let n={...t.selectedArea};if(ej(n,ek)&&(n=eJ(t,x)),0===n.startColIdx)return t;let o=ta(t,"Left"),r=-1;return tS(t,n,"Left")&&(r=0),tS(t,n,"Right")?n.startColIdx===t.paneRanges.Right.startColIdx&&(r=o?t.paneRanges.Left.endColIdx:t.paneRanges.Right.startColIdx):r=n.startColIdx===t.paneRanges.Left.endColIdx?0:t.paneRanges.Left.endColIdx,{selectedArea:{...eQ(t,{...n,startColIdx:r})}}}case"End":{e.preventDefault();let n={...t.selectedArea};ej(n,ek)&&(n=eJ(t,x));let o=t.columns.length;if(n.endColIdx===o)return t;let r=ta(t,"Right"),l=-1;return l=tS(t,n,"Left")?n.endColIdx===t.paneRanges.Left.endColIdx?r?t.paneRanges.Right.startColIdx:o:t.paneRanges.Left.endColIdx:tS(t,n,"Right")?o:n.endColIdx===t.paneRanges.Right.startColIdx?r?t.paneRanges.Right.endColIdx:o:t.paneRanges.Right.startColIdx,{selectedArea:{...eQ(t,{...n,endColIdx:l})}}}case" ":{e.preventDefault();let n={...t.selectedArea};ej(n,ek)&&(n=eJ(t,x));let o=eQ(t,{...n,startColIdx:0,endColIdx:t.columns.length});return{...t,selectedArea:{...o}}}case"Enter":return e.preventDefault(),n.moveHorizontallyOnEnter?ty(t,x,"left"):ty(t,x,"up")}switch(e.key){case"Escape":return null==(c=tg(x.rowIndex,x.colIndex))||c.focus({preventScroll:!0}),t;case"Backspace":case"Delete":{let e=t.selectedArea;ej(e,ek)&&(e=eJ(t,x));let n=[];for(let o=e.startRowIdx;o<e.endRowIdx;o++)for(let r=e.startColIdx;r<e.endColIdx;r++){let e=t.cellsLookup.get(`${o} ${r}`);e&&n.push(e)}return n.forEach(e=>e.onStringValueReceived("")),t}case"Tab":return e.preventDefault(),e.shiftKey?I?ty(t,x,"left"):tv(t,x):I?ty(t,x,"right"):tC(t,x);case"Enter":{e.preventDefault();let o=e6(t,x,t.selectedArea);return n.moveHorizontallyOnEnter?o?ty(t,x,"right"):tC(t,x):o?ty(t,x,"down"):tR(t,x)}case"ArrowUp":return e.preventDefault(),tw(t,x);case"ArrowDown":return e.preventDefault(),tR(t,x);case"ArrowLeft":return e.preventDefault(),tv(t,x);case"ArrowRight":return e.preventDefault(),tC(t,x);case"Home":return e.preventDefault(),null==(u=tg(x.rowIndex,0))||u.focus({preventScroll:!0}),{selectedArea:ek};case"End":return e.preventDefault(),null==(f=tg(x.rowIndex,t.columns.length-1))||f.focus({preventScroll:!0}),{selectedArea:ek};case"PageUp":return e.preventDefault(),t;default:return t}},tL=e=>{let{selectedArea:t,getCellByIndexes:n}=e,o=0;for(let r=t.startColIdx;r<t.endColIdx;){let t=n(0,r);if(t){let n=e0(e,t);n&&(o+=n.offsetWidth),r+=t.colSpan?t.colSpan:1}else r++}return o},tB=e=>{let t=e.getCellByIndexes(0,e.columns.length-1),n=e0(e,t),o=n.offsetLeft,r=n.offsetWidth;return{lastColumnRelativeffsetLeft:o,lastColumnClientOffsetLeft:n.getBoundingClientRect().left,lastColumnCellWidth:r}},tj=e=>{let t=e.className.split(" "),n=null,o=null;return t.forEach(e=>{e.startsWith("rgFocusRowIdx-")?n=parseInt(e.split("-")[1],10):e.startsWith("rgFocusColIdx-")&&(o=parseInt(e.split("-")[1],10))}),null!==n&&null!==o?{rowIndex:n,colIndex:o}:{rowIndex:-1,colIndex:-1}},tk=(e,t)=>{let n=e.getRowAmount();for(let o=0;o<n;o++){let n=e.cells.get(`${o} ${t}`);if(!n)continue;let r=eJ(e,n);if("originColIndex"in n&&r.endColIdx-r.startColIdx>1&&t!==n.originColIndex)return n}},tT=0,t$=0,tP=0,tO={id:"ColumnReorder",handlePointerDown:function(e,t){return t},handlePointerMove:(e,t)=>tE(t,e),handlePointerUp:function(e,t){return tF(t,e)},handlePointerHold:function(e,t){return t},handleFocus:(e,t)=>{let n=document.activeElement;if(!n)return t;let{rowIndex:o,colIndex:r}=tj(n);return -1===o||-1===r?t:{focusedLocation:{rowIndex:o,colIndex:r}}},handlePointerHoldTouch:function(e,t){return t},handlePointerDownTouch:function(e,t){return t},handlePointerMoveTouch:function(e,t){return tE(t,e)},handlePointerUpTouch:function(e,t){return tF(t,e)}},tE=(e,t)=>{var n,o;let r;tT||(tT=t.clientX);let{rowIndex:l,colIndex:a}=e2(t.clientX,t.clientY),d=e.getCellByIndexes(l,a);d&&te(e,d,{rowIndex:l,colIndex:a},!0);let i=tL(e),{lastColumnRelativeffsetLeft:s,lastColumnCellWidth:c}=tB(e),u=e.getCellByIndexes(0,e.selectedArea.startColIdx);if(!u)return e;let f=e0(e,u);if(!f)return e;let x=f.offsetLeft||0,I=null==(o=null==(n=e.reactGridRef)?void 0:n.getBoundingClientRect())?void 0:o.left;if(void 0===I)return e;t$||(t$=t.clientX-I-x);let p=t.clientX-I-t$,h=e1(t.clientX,f.getBoundingClientRect().top);if(!h)return e;let g=e5(h);if(!g)return e;let w=eQ(e,{startRowIdx:0,endRowIdx:e.rows.length,startColIdx:g.colIndex,endColIdx:g.colIndex+1}),C=e.getCellByIndexes(w.startRowIdx,w.startColIdx),R=e.getCellByIndexes(w.startRowIdx,w.endColIdx-1);if(!C||!R)return e;let v=e0(e,C),y=e0(e,R);if(!v||!y)return e;let m=e.selectedArea.startColIdx<e.paneRanges.Left.endColIdx&&e.selectedArea.endColIdx>e.paneRanges.Left.endColIdx,b=e.selectedArea.startColIdx<e.paneRanges.Right.startColIdx&&e.selectedArea.endColIdx>e.paneRanges.Right.startColIdx;if(m||b)r=void 0;else if(t.clientX>f.getBoundingClientRect().left+i){if(ti(e,{rowIndex:0,colIndex:tP=w.endColIdx-1},"Right"))r=void 0;else{let t=e.selectedArea.endColIdx-e.selectedArea.startColIdx,n=tP+1-t;if(tl(e,R,"TopRight")){if(n>=e.paneRanges.Right.startColIdx){let n,o;e.selectedArea.startColIdx<e.paneRanges.TopLeft.endColIdx&&(n=tk(e,e.paneRanges.TopLeft.endColIdx+t)),e.selectedArea.endColIdx<=e.paneRanges.Right.startColIdx&&(o=tk(e,e.paneRanges.Right.startColIdx+t)),n||o||(r=y.offsetLeft+y.offsetWidth)}else{let n;e.selectedArea.startColIdx<e.paneRanges.TopLeft.endColIdx&&(n=tk(e,e.paneRanges.Left.endColIdx+t)),tk(e,e.selectedArea.endColIdx-(tP+1-e.paneRanges.Right.startColIdx))||n||(r=y.offsetLeft+y.offsetWidth)}}else if(e.selectedArea.startColIdx<e.paneRanges.TopLeft.endColIdx&&tP+1>e.paneRanges.TopLeft.endColIdx){if(n===e.paneRanges.TopLeft.endColIdx)r=y.offsetLeft+y.offsetWidth;else if(n<e.paneRanges.TopLeft.endColIdx)tk(e,e.selectedArea.endColIdx-(tP+1-e.paneRanges.TopLeft.endColIdx))||(r=y.offsetLeft+y.offsetWidth);else{let n=tk(e,e.paneRanges.TopLeft.endColIdx+t);(!n||"originColIndex"in n&&n.originColIndex+t===e.paneRanges.TopLeft.endColIdx)&&(r=y.offsetLeft+y.offsetWidth)}}else r=y.offsetLeft+y.offsetWidth}}else if(t.clientX<f.getBoundingClientRect().left-1){if(ti(e,{rowIndex:0,colIndex:tP=w.startColIdx},"Left"))r=void 0;else{let t=e.selectedArea.endColIdx-e.selectedArea.startColIdx,n=tP+t;if(tl(e,C,"TopLeft")){if(e.selectedArea.endColIdx<=e.paneRanges.Left.endColIdx)r=v.offsetLeft;else if(n<=e.paneRanges.Left.endColIdx){let o;e.selectedArea.endColIdx>e.paneRanges.Right.startColIdx&&(o=tk(e,e.paneRanges.Right.startColIdx-t));let l=tk(e,e.paneRanges.Left.endColIdx-t);(l||o)&&(!l||n!==e.paneRanges.Left.endColIdx)||(r=v.offsetLeft)}else{let n;e.selectedArea.endColIdx>e.paneRanges.Right.startColIdx&&(n=tk(e,e.paneRanges.Right.startColIdx-t)),tk(e,e.selectedArea.startColIdx+(e.paneRanges.Left.endColIdx-tP))||n||(r=v.offsetLeft)}}else if(e.selectedArea.endColIdx>e.paneRanges.TopRight.startColIdx){if(tP>=e.paneRanges.TopRight.startColIdx)r=v.offsetLeft;else if(n>e.paneRanges.TopRight.startColIdx)tk(e,e.selectedArea.endColIdx-(n-e.paneRanges.TopRight.startColIdx))||(r=v.offsetLeft);else{let n=tk(e,e.paneRanges.TopRight.startColIdx-t);(!n||"originColIndex"in n&&n.originColIndex-t===e.paneRanges.TopRight.startColIdx)&&(r=v.offsetLeft)}}else r=v.offsetLeft}}return p<0&&(p=0),p+i>=s+c&&(p=s+c-i),{...e,shadowSize:i,shadowPosition:p,linePosition:r}},tF=(e,t)=>{var n,o,r;if(t$=0,!tT)return{...e,currentBehavior:e.getBehavior("Default")};if(!e.linePosition&&(tT=0,1))return{...e,currentBehavior:e.getBehavior("Default"),shadowPosition:void 0,shadowSize:void 0};tT=0;let l=Array.from({length:e.selectedArea.endColIdx-e.selectedArea.startColIdx},(t,n)=>n+e.selectedArea.startColIdx),a=!!l.find(e=>e>tP),d=l.includes(e.focusedLocation.colIndex),i=e.focusedLocation;if(d){let t=e.focusedLocation.colIndex-e.selectedArea.startColIdx;i={rowIndex:e.focusedLocation.rowIndex,colIndex:a?tP+t:tP-(l.length-1)+t}}else if(a&&e.selectedArea.startColIdx>e.focusedLocation.colIndex&&tP<=e.focusedLocation.colIndex){let t=e.selectedArea.endColIdx-e.selectedArea.startColIdx;i={rowIndex:e.focusedLocation.rowIndex,colIndex:e.focusedLocation.colIndex+t}}else if(!a&&e.selectedArea.endColIdx<=e.focusedLocation.colIndex&&tP>=e.focusedLocation.colIndex){let t=e.selectedArea.endColIdx-e.selectedArea.startColIdx;i={rowIndex:e.focusedLocation.rowIndex,colIndex:e.focusedLocation.colIndex-t}}let{lastColumnCellWidth:s,lastColumnClientOffsetLeft:c}=tB(e);if(t.clientX>c+s){try{null==(n=e.onColumnReorder)||n.call(e,l,e.columns.length-1)}catch(e){console.error(e)}return{currentBehavior:e.getBehavior("Default"),changedFocusedLocation:i,selectedArea:{startRowIdx:0,endRowIdx:e.rows.length,startColIdx:e.columns.length-1-(l.length-1),endColIdx:e.columns.length},shadowPosition:void 0,linePosition:void 0,shadowSize:void 0}}let u=e.reactGridRef;if(!u)return e;if(t.clientX<u.getBoundingClientRect().left){try{null==(o=e.onColumnReorder)||o.call(e,l,0)}catch(e){console.error(e)}return{currentBehavior:e.getBehavior("Default"),changedFocusedLocation:i,selectedArea:{startRowIdx:0,endRowIdx:e.rows.length,startColIdx:0,endColIdx:0+l.length},shadowPosition:void 0,linePosition:void 0,shadowSize:void 0}}let f=e.getCellByIndexes(0,e.selectedArea.startColIdx);if(!f||!e0(e,f))return e;try{null==(r=e.onColumnReorder)||r.call(e,l,tP)}catch(e){console.error(e)}return{currentBehavior:e.getBehavior("Default"),changedFocusedLocation:i,selectedArea:{startRowIdx:0,endRowIdx:e.rows.length,startColIdx:a?tP:tP-(l.length-1),endColIdx:a?tP+l.length:tP+1},shadowPosition:void 0,linePosition:void 0,shadowSize:void 0}},tD=e=>{let{selectedArea:t,getCellByIndexes:n}=e,o=0;for(let r=t.startRowIdx;r<t.endRowIdx;r++){let t=n(r,0);if(t){let n=e0(e,t);n&&(o+=n.offsetHeight)}}return o},tM=e=>{let t=e.getCellByIndexes(e.rows.length-1,0),n=e0(e,t),o=n.offsetTop,r=n.offsetHeight;return{lastRowRelativeOffsetTop:o,lastRowClientOffsetTop:n.getBoundingClientRect().top,lastRowHeight:r}},tz=(e,t)=>{let n=e.getColumnAmount();for(let o=0;o<n;o++){let n=e.cells.get(`${t} ${o}`);if(!n)continue;let r=eJ(e,n);if("originRowIndex"in n&&r.endRowIdx-r.startRowIdx>1&&t!==n.originRowIndex)return n}},tH=0,tN=0,tV=0,tU={id:"RowReorder",handlePointerDown:function(e,t){return t},handlePointerMove:(e,t)=>tG(t,e),handlePointerUp:function(e,t){return tW(t,e)},handleFocus:(e,t)=>{let n=document.activeElement;if(!n)return t;let{rowIndex:o,colIndex:r}=tj(n);return -1===o||-1===r?t:{focusedLocation:{rowIndex:o,colIndex:r}}},handlePointerHold:function(e,t){return t},handlePointerHoldTouch:function(e,t){return t},handlePointerDownTouch:function(e,t){return t},handlePointerMoveTouch:function(e,t){return tG(t,e)},handlePointerUpTouch:function(e,t){return tW(t,e)}},tG=(e,t)=>{var n,o;let r;tH||(tH=t.clientY);let l=e.getCellByIndexes(0,0);if(!l)return e;let a=e0(e,l);if(!a)return e;let{rowIndex:d,colIndex:i}=e2(a.getBoundingClientRect().left,t.clientY),s=e.getCellByIndexes(d,i);s&&te(e,s,{rowIndex:d,colIndex:i},!1,!0);let c=tD(e),{lastRowRelativeOffsetTop:u,lastRowHeight:f}=tM(e),x=e.getCellByIndexes(e.selectedArea.startRowIdx,0);if(!x)return e;let I=e0(e,x);if(!I)return e;let p=I.offsetTop||0,h=null==(o=null==(n=e.reactGridRef)?void 0:n.getBoundingClientRect())?void 0:o.top;if(void 0===h)return e;tN||(tN=t.clientY-h-p);let g=t.clientY-h-tN,w=e1(I.getBoundingClientRect().left,t.clientY);if(!w)return e;let C=e5(w),R=e.getCellByIndexes(C.rowIndex,C.colIndex);if(!R)return e;let v=eJ(e,R),y=eQ(e,{startRowIdx:v.startRowIdx,endRowIdx:v.endRowIdx,startColIdx:0,endColIdx:e.columns.length}),m=e.getCellByIndexes(y.startRowIdx,y.startColIdx),b=e.getCellByIndexes(y.endRowIdx-1,y.startColIdx);if(!m||!b)return e;let S=e0(e,m),A=e0(e,b);if(!S||!A)return e;let _=e.selectedArea.startRowIdx<e.paneRanges.BottomLeft.startRowIdx&&e.selectedArea.endRowIdx>e.paneRanges.BottomLeft.startRowIdx,L=e.selectedArea.startRowIdx<e.paneRanges.TopLeft.endRowIdx&&e.selectedArea.endRowIdx>e.paneRanges.TopLeft.endRowIdx;if(_||L)r=void 0;else if(t.clientY>I.getBoundingClientRect().top+c){if(ti(e,{rowIndex:tV=y.endRowIdx-1,colIndex:0},"BottomCenter"))r=void 0;else{let t=e.selectedArea.endRowIdx-e.selectedArea.startRowIdx,n=tV+1-t;if(tl(e,b,"BottomLeft")){if(n>=e.paneRanges.BottomLeft.startRowIdx){let n,o;e.selectedArea.startRowIdx<e.paneRanges.TopLeft.endRowIdx&&(n=tz(e,e.paneRanges.TopLeft.endRowIdx+t)),e.selectedArea.endRowIdx<=e.paneRanges.BottomLeft.startRowIdx&&(o=tz(e,e.paneRanges.BottomLeft.startRowIdx+t)),n||o||(r=A.offsetTop+A.offsetHeight)}else{let n;e.selectedArea.startRowIdx<e.paneRanges.TopLeft.endRowIdx&&(n=tz(e,e.paneRanges.TopLeft.endRowIdx+t)),tz(e,e.selectedArea.endRowIdx-(tV+1-e.paneRanges.BottomCenter.startRowIdx))||n||(r=A.offsetTop+A.offsetHeight)}}else if(e.selectedArea.startRowIdx<e.paneRanges.TopLeft.endRowIdx&&tV+1>e.paneRanges.TopLeft.endRowIdx){if(n===e.paneRanges.TopLeft.endRowIdx)r=A.offsetTop+A.offsetHeight;else if(n<e.paneRanges.TopLeft.endRowIdx)tz(e,e.selectedArea.endRowIdx-(tV+1-e.paneRanges.TopLeft.endRowIdx))||(r=A.offsetTop+A.offsetHeight);else{let n=tz(e,e.paneRanges.TopLeft.endRowIdx+t);(!n||"originRowIndex"in n&&n.originRowIndex-t===e.paneRanges.TopLeft.endRowIdx)&&(r=A.offsetTop+A.offsetHeight)}}else r=A.offsetTop+A.offsetHeight}}else if(t.clientY<I.getBoundingClientRect().top-1){if(ti(e,{rowIndex:tV=y.startRowIdx,colIndex:0},"TopCenter"))r=void 0;else{let t=e.selectedArea.endRowIdx-e.selectedArea.startRowIdx,n=tV+t;if(tl(e,m,"TopLeft")){if(e.selectedArea.endRowIdx<=e.paneRanges.TopLeft.endRowIdx)r=S.offsetTop;else if(n<=e.paneRanges.TopLeft.endRowIdx){let n;e.selectedArea.endRowIdx>e.paneRanges.BottomLeft.startRowIdx&&(n=tz(e,e.paneRanges.BottomLeft.startRowIdx-t));let o=tz(e,e.paneRanges.TopLeft.endRowIdx-t);(!o&&!n||o&&"originRowIndex"in o&&o.originRowIndex+t===e.paneRanges.TopLeft.endRowIdx)&&(r=S.offsetTop)}}else e.selectedArea.endRowIdx>e.paneRanges.BottomLeft.startRowIdx&&tV<e.paneRanges.BottomLeft.startRowIdx?n>e.paneRanges.BottomLeft.startRowIdx?tz(e,e.selectedArea.startRowIdx+(e.paneRanges.BottomLeft.startRowIdx-tV))||(r=S.offsetTop):tz(e,e.paneRanges.BottomLeft.startRowIdx-t)||(r=S.offsetTop):r=S.offsetTop}}return g<0&&(g=0),g+c>=u+f&&(g=u+f-c),e.rows[d].reorderable?{...e,shadowSize:c,shadowPosition:g,linePosition:r}:{...e,shadowSize:c,shadowPosition:g,linePosition:void 0}},tW=(e,t)=>{var n,o,r;if(tN=0,!tH)return{...e,lineOrientation:"vertical",currentBehavior:e.getBehavior("Default")};if(!e.linePosition&&(tH=0,1))return{...e,currentBehavior:e.getBehavior("Default"),shadowPosition:void 0,lineOrientation:"vertical",shadowSize:void 0};tH=0;let l=Array.from({length:e.selectedArea.endRowIdx-e.selectedArea.startRowIdx},(t,n)=>n+e.selectedArea.startRowIdx),a=!!l.find(e=>e>tV),d=l.includes(e.focusedLocation.rowIndex),i=e.focusedLocation;if(d){let t=e.focusedLocation.rowIndex-e.selectedArea.startRowIdx;i={rowIndex:a?tV+t:tV-(l.length-1)+t,colIndex:e.focusedLocation.colIndex}}else if(a&&e.selectedArea.startRowIdx>e.focusedLocation.rowIndex&&tV<=e.focusedLocation.rowIndex){let t=e.selectedArea.endRowIdx-e.selectedArea.startRowIdx;i={rowIndex:e.focusedLocation.rowIndex+t,colIndex:e.focusedLocation.colIndex}}else if(!a&&e.selectedArea.endRowIdx<=e.focusedLocation.rowIndex&&tV>=e.focusedLocation.rowIndex){let t=e.selectedArea.endRowIdx-e.selectedArea.startRowIdx;i={rowIndex:e.focusedLocation.rowIndex-t,colIndex:e.focusedLocation.colIndex}}let{lastRowHeight:s,lastRowClientOffsetTop:c}=tM(e);if(t.clientY>c+s){try{null==(n=e.onRowReorder)||n.call(e,l,e.rows.length-1)}catch(e){console.error(e)}return{currentBehavior:e.getBehavior("Default"),changedFocusedLocation:i,selectedArea:{startRowIdx:e.rows.length-1-(l.length-1),endRowIdx:e.rows.length,startColIdx:0,endColIdx:e.columns.length},shadowPosition:void 0,linePosition:void 0,lineOrientation:"vertical",shadowSize:void 0}}let u=e.reactGridRef;if(!u)return e;if(t.clientY<u.getBoundingClientRect().top){try{null==(o=e.onRowReorder)||o.call(e,l,0)}catch(e){console.error(e)}return{currentBehavior:e.getBehavior("Default"),changedFocusedLocation:i,selectedArea:{startRowIdx:0,endRowIdx:0+l.length,startColIdx:0,endColIdx:e.columns.length},shadowPosition:void 0,linePosition:void 0,lineOrientation:"vertical",shadowSize:void 0}}let f=e.getCellByIndexes(e.selectedArea.startRowIdx,0);if(!f||!e0(e,f))return e;try{null==(r=e.onRowReorder)||r.call(e,l,tV)}catch(e){console.error(e)}return{currentBehavior:e.getBehavior("Default"),changedFocusedLocation:i,selectedArea:{startRowIdx:a?tV:tV-(l.length-1),endRowIdx:a?tV+l.length:tV+1,startColIdx:0,endColIdx:e.columns.length},shadowPosition:void 0,linePosition:void 0,lineOrientation:"vertical",shadowSize:void 0}};function tX(e,t){let n=e.cells;for(let o=t.startColIdx;o<t.endColIdx;o++){let t=n.get(`0 ${o}`);if(!t)return e.selectedArea;if(eq(t)){let n=e.getCellByIndexes(t.originRowIndex,t.originColIndex);if(n&&(!1===n.isSelectable||!1===n.isFocusable))return e.selectedArea}else if(!1===t.isSelectable||!1===t.isFocusable)return e.selectedArea}return eQ(e,{startRowIdx:0,endRowIdx:e.rows.length,startColIdx:t.startColIdx,endColIdx:t.endColIdx})}function tZ(e,t){let n=e.cells;for(let o=t.startRowIdx;o<t.endRowIdx;o++){let t=n.get(`${o} 0`);if(!t)return e.selectedArea;if(eq(t)){let n=e.getCellByIndexes(t.originRowIndex,t.originColIndex);if(n&&(!1===n.isSelectable||!1===n.isFocusable))return e.selectedArea}else if(!1===t.isSelectable||!1===t.isFocusable)return e.selectedArea}return eQ(e,{startRowIdx:t.startRowIdx,endRowIdx:t.endRowIdx,startColIdx:0,endColIdx:e.columns.length})}function tY(e,t,n){switch(t){case"row":return e6(e,n,e.selectedArea)&&e.selectedArea.endColIdx===e.columns.length&&!!e.onRowReorder&&!!e.rows[n.rowIndex].reorderable;case"column":return e6(e,n,e.selectedArea)&&e.selectedArea.endRowIdx===e.rows.length&&!!e.onColumnReorder&&!!e.columns[n.colIndex].reorderable}}let tq=e=>e===tU.id||e===tO.id;function tK(e,t){var n;if(!e.reactGridRef)return;let o=null==(n=e.reactGridRef)?void 0:n.getElementsByClassName(`rgRowIdx-${t.rowIndex} rgColIdx-${t.colIndex}`);if(!(!o||(null==o?void 0:o.length)===0)){if((null==o?void 0:o.length)!==1)throw Error("Cell container is not unique!");return o[0]}}let tJ=!1,tQ=()=>({id:"Default",handlePointerDown:function(e,t){var n;let o=e1(e.clientX,e.clientY);if(!o)return t;let{rowIndex:r,colIndex:l}=to(o),a=e9(o,!0)??t.reactGridRef;th(t,r,l,a);let d=t.getCellByIndexes(r,l);if(!d)return t;let i=0===r&&t.enableColumnSelectionOnFirstRow,s=0===l&&t.enableRowSelectionOnFirstColumn,c=!0;i?t.selectedArea.endRowIdx===t.rows.length&&(c=!e6(t,d,t.selectedArea)):s&&t.selectedArea.endColIdx===t.columns.length&&(c=!e6(t,d,t.selectedArea));let u=eJ(t,d),f=t.currentBehavior,x=ek;if(i?(tY(t,"column",d)&&(f=tO),f.id!==tO.id&&(x=tX(t,u))):s&&(tY(t,"row",d)&&(f=tU),f.id!==tU.id&&(x=tZ(t,u))),tJ){let e=t.getFocusedCell();if(!e)return t;let n=eJ(t,e),o={startRowIdx:Math.min(n.startRowIdx,u.startRowIdx),endRowIdx:Math.max(n.endRowIdx,u.endRowIdx),startColIdx:Math.min(n.startColIdx,u.startColIdx),endColIdx:Math.max(n.endColIdx,u.endColIdx)};return tJ=!1,{selectedArea:o}}return c?((null==d?void 0:d.isFocusable)!==!1&&(null==(n=tg(r,l))||n.focus({preventScroll:!0})),{selectedArea:x,pointerStartIdx:{rowIndex:r,colIndex:l}}):tq(f.id)?{...f.id===tU.id&&{lineOrientation:"horizontal"},currentBehavior:f,pointerStartIdx:{rowIndex:r,colIndex:l}}:{pointerStartIdx:{rowIndex:r,colIndex:l}}},handleFocus:(e,t)=>{let n=document.activeElement;if(!n)return t;let{rowIndex:o,colIndex:r}=tj(n);return -1===o||-1===r?t:{focusedLocation:{rowIndex:o,colIndex:r}}},handlePointerMove:(e,t)=>{let n=t.getCellByIndexes(t.pointerStartIdx.rowIndex,t.pointerStartIdx.colIndex);return(null==n?void 0:n.isSelectable)===!1?t:{currentBehavior:t.getBehavior("CellSelection")}},handlePointerUp:function(e,t){return t},handlePointerHold:function(e,t){return t},handlePointerHoldTouch:function(e,t){return t},handleKeyDown:function(e,t){return"Shift"===e.key&&(tJ=!0),t_(e,t,{moveHorizontallyOnEnter:t.moveRightOnEnter})},handleKeyUp:function(e,t){return"Shift"===e.key&&(tJ=!1),t},handlePointerDownTouch:function(e,t){var n;let{rowIndex:o,colIndex:r}=e2(e.clientX,e.clientY),l=0===o&&t.enableColumnSelectionOnFirstRow,a=0===r&&t.enableRowSelectionOnFirstColumn,d=t.getCellByIndexes(o,r);if(!d)return t;let i=t.currentBehavior,s=eJ(t,d),c=ek,u=!0;return l?t.selectedArea.endRowIdx===t.rows.length&&(u=!e6(t,d,t.selectedArea)):a&&t.selectedArea.endColIdx===t.columns.length&&(u=!e6(t,d,t.selectedArea)),l?(tY(t,"column",d)&&(i=tO),i.id!==tO.id&&(c=tX(t,s))):a&&(tY(t,"row",d)&&(i=tU),i.id!==tU.id&&(c=tZ(t,s))),u&&(l||a)?((null==d?void 0:d.isFocusable)!==!1&&(null==(n=tg(o,r))||n.focus({preventScroll:!0})),{selectedArea:c,pointerStartIdx:{rowIndex:o,colIndex:r}}):tq(i.id)?{...i.id===tU.id&&{lineOrientation:"horizontal"},currentBehavior:i,pointerStartIdx:{rowIndex:o,colIndex:r}}:{pointerStartIdx:{rowIndex:o,colIndex:r}}},handlePointerMoveTouch:function(e,t){let n=0===t.pointerStartIdx.rowIndex&&t.enableColumnSelectionOnFirstRow,o=0===t.pointerStartIdx.colIndex&&t.enableRowSelectionOnFirstColumn;if(n||o)return{...t,currentBehavior:t.getBehavior("CellSelection")};let r=t.getCellByIndexes(t.pointerStartIdx.rowIndex,t.pointerStartIdx.colIndex);return t.pointerStartIdx.rowIndex!==t.focusedLocation.rowIndex||t.pointerStartIdx.colIndex!==t.focusedLocation.colIndex||(null==r?void 0:r.isSelectable)===!1?t:{...t,currentBehavior:t.getBehavior("CellSelection")}},handlePointerUpTouch:function(e,t){var n;let o=e1(e.clientX,e.clientY);if(!o)return t;let{rowIndex:r,colIndex:l}=to(o),a=t.getCellByIndexes(r,l),d=e9(o,!0)??t.reactGridRef;th(t,r,l,d);let i=tK(t,t.pointerStartIdx),s=tK(t,{rowIndex:r,colIndex:l});if(i&&s){let e=to(i),o=to(s),d=0===l&&t.enableRowSelectionOnFirstColumn,c=0===o.rowIndex&&t.enableColumnSelectionOnFirstRow;if(e.rowIndex===o.rowIndex&&e.colIndex===o.colIndex&&(c||(null==a?void 0:a.isFocusable)===!1||null==(n=tg(r,l))||n.focus({preventScroll:!0}),!c&&!d))return{selectedArea:ek}}return t},handleCopy:function(e,t){var n;let o;e.preventDefault();let r=t.getCellByIndexes(t.focusedLocation.rowIndex,t.focusedLocation.colIndex);return r&&(o=ej(t.selectedArea,ek)?eJ(t,r):t.selectedArea,t.onCopy&&null!=(n=t.onCopy)&&n.call(t,e,o,t.cellsLookup)||t0(e,t,o)),t},handleCut:function(e,t){var n;let o;e.preventDefault();let r=t.getCellByIndexes(t.focusedLocation.rowIndex,t.focusedLocation.colIndex);return r&&(o=ej(t.selectedArea,ek)?eJ(t,r):t.selectedArea,t.onCut&&null!=(n=t.onCut)&&n.call(t,e,o,t.cellsLookup)||t1(e,t,o)),t},handlePaste:function(e,t){var n;let o;e.preventDefault();let r=t.getCellByIndexes(t.focusedLocation.rowIndex,t.focusedLocation.colIndex);return r?(o=ej(t.selectedArea,ek)?eJ(t,r):t.selectedArea,t.onPaste&&(null==(n=t.onPaste)?void 0:n.call(t,e,o,t.cellsLookup)))?t:t5(e,t,o):t}}),t0=(e,t,n)=>{let{startRowIdx:o,endRowIdx:r,startColIdx:l,endColIdx:a}=n,d=[];for(let e=o;e<r;e++)for(let n=l;n<a;n++){let o=t.cellsLookup.get(`${e} ${n}`);o&&d.push(o)}let i=d.filter(e=>e&&Object.keys(e).length>0).map(e=>e.onStringValueRequested()),s=`
  <table>
    ${Array.from({length:n.endRowIdx-n.startRowIdx},(e,o)=>`
      <tr>
        ${Array.from({length:n.endColIdx-n.startColIdx},(e,r)=>{var l;let a=t.cellsLookup.get(`${n.startRowIdx+o} ${n.startColIdx+r}`);return`<td>${(null==(l=null==a?void 0:a.onStringValueRequested)?void 0:l.call(a))||""}</td>`}).join("")}
      </tr>
    `).join("")}
  </table>
`;e.clipboardData.setData("text/html",s),e.clipboardData.setData("text/plain",i.join("	"))},t1=(e,t,n)=>{let{startRowIdx:o,endRowIdx:r,startColIdx:l,endColIdx:a}=n,d=[];for(let e=o;e<r;e++)for(let n=l;n<a;n++){let o=t.cellsLookup.get(`${e} ${n}`);o&&d.push(o)}let i=d.filter(e=>e&&Object.keys(e).length>0).map(e=>e.onStringValueRequested());d.forEach(e=>{var t;return e&&(null==(t=e.onStringValueReceived)?void 0:t.call(e,""))});let s=`
  <table>
    ${Array.from({length:n.endRowIdx-n.startRowIdx},(e,o)=>`
      <tr>
        ${Array.from({length:n.endColIdx-n.startColIdx},(e,r)=>{var l;let a=t.cellsLookup.get(`${n.startRowIdx+o} ${n.startColIdx+r}`);return`<td>${(null==(l=null==a?void 0:a.onStringValueRequested)?void 0:l.call(a))||""}</td>`}).join("")}
      </tr>
    `).join("")}
  </table>
`;e.clipboardData.setData("text/html",s),e.clipboardData.setData("text/plain",i.join("	"))},t5=(e,t,n)=>{let o;let r=e.clipboardData.getData("text/html"),l=new DOMParser().parseFromString(r,"text/html").querySelectorAll("tr"),a=l[0].querySelectorAll("td");if(1===l.length&&1===a.length){let e=a[0].textContent||"";for(let o=n.startRowIdx;o<n.endRowIdx;o++)for(let r=n.startColIdx;r<n.endColIdx;r++){let n=t.cellsLookup.get(`${o} ${r}`);null==n||n.onStringValueReceived(e)}}else l.forEach((e,o)=>{e.querySelectorAll("td").forEach((e,r)=>{var l;let a=e.textContent||"",d=t.cellsLookup.get(`${n.startRowIdx+o} ${n.startColIdx+r}`);d&&(null==(l=d.onStringValueReceived)||l.call(d,a))})});if(1===l.length&&1===a.length)o={startRowIdx:n.startRowIdx,endRowIdx:n.endRowIdx,startColIdx:n.startColIdx,endColIdx:n.endColIdx};else{let e=Math.min(n.startRowIdx+l.length,t.rows.length),r=Math.min(n.startColIdx+l[0].querySelectorAll("td").length,t.columns.length);o={startRowIdx:n.startRowIdx,endRowIdx:e,startColIdx:n.startColIdx,endColIdx:r}}return{...t,selectedArea:o}},t2=(e,t,n)=>{var o,r;let l=e1(t,n);if(l){let{rowIndex:n,colIndex:a}=to(l),d=e.getCellByIndexes(n,a);if(!d)return -1;let i=e0(e,d);return i?d&&d.colSpan?a+Math.floor((t-(null==(o=null==i?void 0:i.getBoundingClientRect)?void 0:o.call(i).left))/((null==(r=i.getBoundingClientRect)?void 0:r.call(i).width)/d.colSpan)):a:-1}return -1},t4=(e,t,n)=>{var o,r;let l=e1(t,n);if(l){let{rowIndex:t,colIndex:a}=to(l),d=e.getCellByIndexes(t,a);if(!d)return -1;let i=e0(e,d);return i?d&&d.rowSpan?t+Math.floor((n-(null==(o=null==i?void 0:i.getBoundingClientRect)?void 0:o.call(i).top))/((null==(r=i.getBoundingClientRect)?void 0:r.call(i).height)/d.rowSpan)):t:-1}return -1},t3=(e,t)=>{let n;let o=t4(e,t.clientX,t.clientY),r=t2(e,t.clientX,t.clientY),l=e.getCellByIndexes(e.focusedLocation.rowIndex,e.focusedLocation.colIndex);if(-1===r)return;let a=e.selectedArea;n=-1!==e.selectedArea.startRowIdx?a:l?eJ(e,l):ek;let d=[];return d.push({direction:"",value:null}),d.push({direction:"up",value:o<n.startRowIdx?o:null}),d.push({direction:"down",value:o>=n.endRowIdx?o:null}),d.push({direction:"left",value:r<n.startColIdx?r:null}),d.push({direction:"right",value:r>=n.endColIdx?r:null}),d.every(e=>null===e.value)?d[0]:d.reduce((e,t)=>null!==t.value?t:e)},t6={id:"FillHandle",handlePointerDown:function(e,t){return t},handlePointerMove:function(e,t){return t9(t,e)},handlePointerUp:function(e,t){return t7(t)},handlePointerDownTouch:function(e,t){return t},handlePointerMoveTouch:function(e,t){return t9(t,e)},handlePointerUpTouch:function(e,t){return t7(t)}},t9=(e,t)=>{let n;let{clientX:o,clientY:r}=t,l=e2(o,r),a=e.getCellByIndexes(l.rowIndex,l.colIndex);n=eZ(e.selectedArea,ek)?e3(e,e.getFocusedCell()):e3(e,e.getCellByIndexes(e.selectedArea.endRowIdx-1,e.selectedArea.endColIdx-1)),a&&("Center"===n&&te(e,a,l),("Left"===n||"Right"===n)&&te(e,a,l,!1,!0),("TopCenter"===n||"BottomCenter"===n)&&te(e,a,l,!0));let d=t3(e,t),i=e.getCellByIndexes(e.focusedLocation.rowIndex,e.focusedLocation.colIndex),s=e.selectedArea,c=-1!==e.selectedArea.startRowIdx,u=i?eJ(e,i):ek;if(!d||null===d.value)return{fillHandleArea:ek};switch(null==d?void 0:d.direction){case"up":return{fillHandleArea:{startColIdx:c?s.startColIdx:u.startColIdx,startRowIdx:d.value,endColIdx:c?s.endColIdx:u.endColIdx,endRowIdx:c?s.startRowIdx:u.startRowIdx}};case"right":return{fillHandleArea:{startColIdx:c?s.endColIdx:u.endColIdx,startRowIdx:c?s.startRowIdx:u.startRowIdx,endColIdx:d.value+1,endRowIdx:c?s.endRowIdx:u.endRowIdx}};case"down":return{fillHandleArea:{startColIdx:c?s.startColIdx:u.startColIdx,startRowIdx:c?s.endRowIdx:u.endRowIdx,endColIdx:c?s.endColIdx:u.endColIdx,endRowIdx:d.value+1}};case"left":return{fillHandleArea:{startColIdx:d.value,startRowIdx:c?s.startRowIdx:u.startRowIdx,endColIdx:c?s.startColIdx:u.startColIdx,endRowIdx:c?s.endRowIdx:u.endRowIdx}}}return e},t7=e=>{let t=function(e){let{fillHandleArea:t,selectedArea:n,getFocusedCell:o}=e,r=o(),l=r?eJ(e,r):ek,a=eZ(n,ek)?l:n;return t.startRowIdx===a.endRowIdx?"bottom":t.endRowIdx===a.startRowIdx?"top":t.startColIdx===a.endColIdx?"right":t.endColIdx===a.startColIdx?"left":""}(e),n=e.getCellByIndexes(e.focusedLocation.rowIndex,e.focusedLocation.colIndex),o=e.selectedArea,r=e.cellsLookup;if(-1!==e.fillHandleArea.startRowIdx){let t;t=-1!==e.selectedArea.startRowIdx?e.selectedArea:n?eJ(e,n):ek,e.onFillHandle&&e.onFillHandle(t,e.fillHandleArea,r)||t8(t,e.fillHandleArea,r)}let l=-1!==o.startRowIdx,a=e.fillHandleArea;return eZ(a,ek)?{...e,fillHandleArea:ek,currentBehavior:e.getBehavior("Default")}:("bottom"===t?l?a.startRowIdx=e.selectedArea.startRowIdx:a.startRowIdx=a.startRowIdx-(((null==n?void 0:n.rowSpan)??1)||1):"top"===t?l?a.endRowIdx=e.selectedArea.endRowIdx:a.endRowIdx=a.endRowIdx+(((null==n?void 0:n.rowSpan)??1)||1):"right"===t?l?a.startColIdx=e.selectedArea.startColIdx:a.startColIdx=a.startColIdx-(((null==n?void 0:n.colSpan)??1)||1):"left"===t&&(l?a.endColIdx=e.selectedArea.endColIdx:a.endColIdx=a.endColIdx+(((null==n?void 0:n.colSpan)??1)||1)),{...e,selectedArea:a,fillHandleArea:ek,currentBehavior:e.getBehavior("Default")})},t8=(e,t,n)=>{let o=t.startRowIdx<e.startRowIdx,r=e.endRowIdx-e.startRowIdx,l=e.endColIdx-e.startColIdx;for(let a=t.startRowIdx;a<t.endRowIdx;a++)for(let d=t.startColIdx;d<t.endColIdx;d++){let i=n.get(`${a} ${d}`);if(!i||0===a)continue;let s=o?(e.endRowIdx-a-1)%r:(a-t.startRowIdx)%r,c=(d-t.startColIdx)%l,u=n.get(`${e.startRowIdx+s} ${e.startColIdx+c}`),f=e=>!!e&&Object.keys(e).length>0;if(f(u)&&f(i)){let e=u.onStringValueRequested();i.onStringValueReceived(e)}}},ne=0,nt=0,nn=0,no={id:"ResizeColumn",handlePointerDown:function(e,t){return nr(e,t)},handlePointerMove:(e,t)=>nl(e,t),handlePointerUp:function(e,t){return na(e,t)},handlePointerHold:function(e,t){return t},handlePointerHoldTouch:function(e,t){return t},handlePointerDownTouch:function(e,t){return nr(e,t)},handlePointerMoveTouch:function(e,t){return nl(e,t)},handlePointerUpTouch:function(e,t){return na(e,t)}},nr=(e,t)=>{let n=e.target.parentNode,o=n.offsetWidth;return ne=n.offsetLeft,nn=o,nt=e.clientX,{...t,lineOrientation:"vertical",linePosition:n.offsetLeft+n.offsetWidth}},nl=(e,t)=>{let n=t.reactGridRef;if(!n)return t;let o=n.getBoundingClientRect().left,r=e.clientX-o,l=t.getCellByIndexes(0,t.resizingColIdx??0),a=(l.colSpan?Array.from({length:l.colSpan},(e,t)=>t+l.colIndex):[l.colIndex]).reduce((e,n)=>{let o=t.getColumnByIdx(n);return e+ts((null==o?void 0:o.minWidth)??0)},0);return{...t,linePosition:r>ne+a?r:ne+a}},na=(e,t)=>{var n,o;let r=e.clientX-nt;if(void 0===t.resizingColIdx)return t;let l=nn+r,a=t.reactGridRef;if(!a)return t;let d=t.getColumnByIdx(t.resizingColIdx),i=ts((null==d?void 0:d.minWidth)??0),s=a.getBoundingClientRect().left,c=e.clientX-s,u=t.getCellByIndexes(0,t.resizingColIdx),f=u.colSpan?Array.from({length:u.colSpan},(e,t)=>t+u.colIndex):[u.colIndex];return c<=ne+i?null==(n=t.onResizeColumn)||n.call(t,i,f):null==(o=t.onResizeColumn)||o.call(t,l,f),ne=0,nt=0,nn=0,{...t,linePosition:void 0,currentBehavior:t.getBehavior("Default"),resizingColIdx:void 0}},nd=(o=()=>({}))?eW(o):eW,ni={rows:[],columns:[],cells:new Map,cellsLookup:new Map,paneRanges:{TopLeft:{startRowIdx:0,endRowIdx:0,startColIdx:0,endColIdx:0},TopCenter:{startRowIdx:0,endRowIdx:0,startColIdx:0,endColIdx:0},TopRight:{startRowIdx:0,endRowIdx:0,startColIdx:0,endColIdx:0},Left:{startRowIdx:0,endRowIdx:0,startColIdx:0,endColIdx:0},Center:{startRowIdx:0,endRowIdx:0,startColIdx:0,endColIdx:0},Right:{startRowIdx:0,endRowIdx:0,startColIdx:0,endColIdx:0},BottomLeft:{startRowIdx:0,endRowIdx:0,startColIdx:0,endColIdx:0},BottomCenter:{startRowIdx:0,endRowIdx:0,startColIdx:0,endColIdx:0},BottomRight:{startRowIdx:0,endRowIdx:0,startColIdx:0,endColIdx:0}},behaviors:{Default:tQ(),CellSelection:tn,ColumnReorder:tO,RowReorder:tU,ResizeColumn:no,FillHandle:t6},styledRanges:[],onFillHandle:void 0,onAreaSelected:void 0,onCellFocused:void 0,onCut:void 0,onPaste:void 0,moveRightOnEnter:!1,rowMeasurements:[],colMeasurements:[],focusedLocation:{rowIndex:-1,colIndex:-1},changedFocusedLocation:void 0,selectedArea:{startRowIdx:-1,endRowIdx:-1,startColIdx:-1,endColIdx:-1},fillHandleArea:{startRowIdx:-1,endRowIdx:-1,startColIdx:-1,endColIdx:-1},reactGridRef:void 0,resizingColIdx:void 0,lineOrientation:"vertical",linePosition:void 0,shadowPosition:void 0,shadowSize:void 0,pointerStartIdx:{rowIndex:-1,colIndex:-1},currentBehavior:tQ()};function ns(e,t){let n=nd()[e];if((null==n?void 0:n.getState())===void 0)throw Error(`ReactGridStore with id "${e}" doesn't exist!`);return eG(n,t)}let nc=(e,t)=>{let n=eG(nd,t=>t[e]),o=null==n?void 0:n.getState();if(o)return t(o)},nu=[["focuschange","focusedLocation"],["selectionchange","selectedArea"]],nf=["focusedLocation","selectedArea"],nx=(e,t,n)=>{let o=e.getState();if(n){let r=n(t,o),l=function(e,t,n){let o={};return n.forEach(n=>{let r=e[n],l=t[n];void 0!==l&&JSON.stringify(r)!==JSON.stringify(l)&&(o[n]={after:l,before:r})}),o}(o,r,nf);return eZ(o,r)?void 0:(function(e){Object.entries(e).forEach(([e,t])=>{let n=function(e){let t=nu.find(([t,n])=>n===e);if(!t)return null;{let[e,n]=t;return e}}(e);n&&tr(n,{[e]:t})})}(l),e.setState(r),r)}},nI=(e,t)=>{let n;let o="mouse"!==e.pointerType;function r(){return t.getState()}(2===e.button||o)&&(n=setTimeout(()=>{l(e,o?r().currentBehavior.handlePointerHoldTouch:r().currentBehavior.handlePointerHold)},500));let l=(e,n)=>nx(t,e,n),a=t.getState(),d=null,i=e=>{l(e,o?r().currentBehavior.handlePointerMoveTouch:r().currentBehavior.handlePointerMove);let t=e1(e.clientX,e.clientY);t&&(d&&!td(t,d)&&s(e),d=t)},s=e=>{l(e,o?r().currentBehavior.handlePointerEnterTouch:r().currentBehavior.handlePointerEnter)},c=e=>{window.removeEventListener("pointermove",i),window.removeEventListener("pointerup",c),n&&clearTimeout(n),l(e,o?r().currentBehavior.handlePointerUpTouch:r().currentBehavior.handlePointerUp)};window.addEventListener("pointermove",i),window.addEventListener("pointerup",c),l(e,o?a.currentBehavior.handlePointerDownTouch:a.currentBehavior.handlePointerDown)},np=({reactGridId:e,style:t,children:n})=>{let o=nd()[e],r=ns(e,e=>e.currentBehavior),a=(0,l.useRef)(null),d=ns(e,e=>e.assignReactGridRef),i=ns(e,e=>e.styledRanges),[s,c]=(0,l.useState)(eP({}));(0,l.useEffect)(()=>{a.current&&d(a.current)},[a]);let u=(e,t)=>nx(o,e,t);return(0,l.useEffect)(()=>{let e=function(e,t){let n=Object.entries(t.map(t=>{let{styles:n,range:o}=t;return{range:e$(e,o),styles:n}}).map(e=>{let t=[],{range:n,styles:o}=e;for(let e=n.startRowIdx;e<n.endRowIdx;e++)for(let o=n.startColIdx;o<n.endColIdx;o++)t.push(`.rgRowIdx-${e}.rgColIdx-${o}`);return{[`${t.join(", ")}`]:o}}).reduce((e,t)=>({...e,...t}),{})).map(([e,t])=>{let n=Object.entries(t).map(([e,t])=>`${e}: ${t};`).join(" ");return`${e} { ${n} }`}).join(" ");return eP`
    ${n}
  `}(o.getState(),i);e&&c(e)},[i.length]),e_("div",{css:s,id:`ReactGrid-${e}`,className:"ReactGrid",ref:a,style:t,onPointerDown:e=>{e.preventDefault(),nI(e,o)},onFocus:e=>u(e,null==r?void 0:r.handleFocus),onKeyDown:e=>u(e,null==r?void 0:r.handleKeyDown),onKeyUp:e=>u(e,null==r?void 0:r.handleKeyUp),onCompositionStart:e=>u(e,null==r?void 0:r.handleCompositionStart),onCompositionUpdate:e=>u(e,null==r?void 0:r.handleCompositionUpdate),onCompositionEnd:e=>u(e,null==r?void 0:r.handleCompositionEnd),onCut:e=>u(e,null==r?void 0:r.handleCut),onCopy:e=>u(e,null==r?void 0:r.handleCopy),onPaste:e=>u(e,null==r?void 0:r.handlePaste),onContextMenu:e=>u(e,null==r?void 0:r.handleContextMenu),children:n})},nh=(0,l.createContext)(""),ng=({id:e,children:t})=>e_(nh.Provider,{value:e,children:t}),nw=()=>l.useContext(nh),nC=()=>{let e=ns(nw(),e=>e.styles);return tu(tI(tf),l.useContext(eR),e)},nR=(e,t)=>{if(e===t)return!0;if(typeof e!=typeof t)return!1;if("function"==typeof e&&"function"==typeof t)return e.toString()===t.toString();if(null===e||null===t||"object"!=typeof e||"object"!=typeof t)return!1;let n=Object.keys(e),o=Object.keys(t);if(n.length!==o.length)return!1;for(let o of n)if(!nR(e[o],t[o]))return!1;return!0},nv=(0,l.createContext)({realRowIndex:-1,realColumnIndex:-1,isCellSelected:!1,isFocused:!1,containerStyle:{}}),ny=()=>{let e=(0,l.useContext)(nv);if(!e)throw Error("CellContext is unavailable! Did you use this hook outside of ReactGrid's PaneGridRenderer?");return e},nm=(0,l.memo)(({rowIndex:e,colIndex:t,realRowIndex:n,realColumnIndex:o,rowSpan:r,colSpan:l,getCellOffset:a=()=>({}),cell:d,isCellSelected:i,isFocused:s})=>{let{Template:c,props:u}=d;return e_(nv.Provider,{value:{realRowIndex:n,realColumnIndex:o,isCellSelected:i,isFocused:s,containerStyle:{...r&&{gridRowEnd:`span ${r}`},...l&&{gridColumnEnd:`span ${l}`},...null==a?void 0:a(e,t,r??1,l??1),gridRowStart:n+1,gridColumnStart:o+1}},children:e_(c,{...u})})},(e,t)=>!t.shouldRenderReorderedCells&&nR(e.cell,t.cell)&&e.isCellSelected===t.isCellSelected&&e.isFocused===t.isFocused&&e.getCellOffset===t.getCellOffset),nb=l.memo(({areaRange:e,parentPaneName:t,parentPaneRange:n,getCellOffset:o,isFocusedCellPartial:r=!1,isFillHandlePartial:l=!1,border:a,style:d,className:i})=>{let s=nC(),c={},u=a??s.area.border,f=nw(),x=nd()[f].getState(),I=ns(f,e=>e.currentBehavior),p=ns(f,e=>e.setCurrentBehavior),h=ns(f,e=>e.selectedArea),g=ns(f,e=>e.paneRanges),w=ns(f,e=>e.fillHandleArea),C=ns(f,e=>e.disableFillHandle),R=x.getCellByIndexes(x.focusedLocation.rowIndex,x.focusedLocation.colIndex)??void 0,v=R?eJ(x,R):ek;if(e.startRowIdx<0||e.startColIdx<0||e.endRowIdx<0||e.endColIdx<0)return null;if(e.startRowIdx>e.endRowIdx)throw Error("Invalid range! Start row index is greater than end row index!");if(e.startColIdx>e.endColIdx)throw Error("Invalid range! Start column index is greater than end column index!");if(e.startColIdx>=n.endColIdx||e.startRowIdx>=n.endRowIdx||e.endColIdx<=n.startColIdx||e.endRowIdx<=n.startRowIdx)return null;let y=!1;e.startRowIdx>=n.startRowIdx&&(l?(h.startRowIdx>v.endRowIdx&&!eZ(h,ek)&&!e6(x,R,h)&&w.startRowIdx<h.startRowIdx||w.startRowIdx!==v.endRowIdx&&w.startRowIdx!==h.endRowIdx)&&(y=!0):y=!0);let m=!1;e.endColIdx<=n.endColIdx&&(l?(h.startColIdx<v.endColIdx&&!eZ(h,ek)&&!e6(x,R,h)&&w.endColIdx>h.endColIdx||w.endColIdx!==v.startColIdx&&w.endColIdx!==h.startColIdx)&&(m=!0):m=!0);let b=!1;e.endRowIdx<=n.endRowIdx&&(l?(h.startRowIdx<v.endRowIdx&&!eZ(h,ek)&&!e6(x,R,h)&&w.endRowIdx>h.endRowIdx||w.endRowIdx!==v.startRowIdx&&w.endRowIdx!==h.startRowIdx)&&(b=!0):b=!0);let S=!1;e.startColIdx>=n.startColIdx&&(l?(h.startColIdx>v.endColIdx&&!eZ(h,ek)&&!e6(x,R,h)&&w.startColIdx<h.startColIdx||w.startColIdx!==v.endColIdx&&w.startColIdx!==h.endColIdx)&&(S=!0):S=!0);let A="100%",_="100%",L={gridRowStart:e.startRowIdx<n.startRowIdx?n.startRowIdx+1:e.startRowIdx+1,gridRowEnd:e.endRowIdx>n.endRowIdx?n.endRowIdx+1:e.endRowIdx+1,gridColumnStart:e.startColIdx<n.startColIdx?n.startColIdx+1:e.startColIdx+1,gridColumnEnd:e.endColIdx>n.endColIdx?n.endColIdx+1:e.endColIdx+1};("TopLeft"===t||"TopCenter"===t||"TopRight"===t)&&(L.position="sticky",c.top=null==o?void 0:o(e.startRowIdx,e.startColIdx,1,1).top,b||(_=`calc(100% - (${u.width} - ${s.gap.width}))`)),("TopRight"===t||"Right"===t||"BottomRight"===t)&&(L.position="sticky",c.right=null==o?void 0:o(e.startRowIdx,e.endColIdx-n.startColIdx-1,1,1).right,S||(A=`calc(100% - (${u.width} - ${s.gap.width}))`)),("BottomLeft"===t||"BottomCenter"===t||"BottomRight"===t)&&(L.position="sticky",c.bottom=null==o?void 0:o(e.endRowIdx-n.startRowIdx-1,e.startColIdx,1,1).bottom,y||(_=`calc(100% - (${u.width} - ${s.gap.width}))`)),("TopLeft"===t||"Left"===t||"BottomLeft"===t)&&(L.position="sticky",c.left=null==o?void 0:o(e.startRowIdx,e.startColIdx,1,1).left,m||(A=`calc(100% - (${u.width} - ${s.gap.width}))`));let B=!1;if(!C){let e=["TopLeft","TopCenter","TopRight"].includes(t),n=["Left","Center","Right"].includes(t),o=e&&h.endRowIdx>g.TopCenter.endRowIdx||n&&h.endRowIdx>g.Center.endRowIdx,a="TopLeft"===t&&h.endColIdx>g.TopLeft.endColIdx||"TopCenter"===t&&h.endColIdx>g.TopCenter.endColIdx||"Left"===t&&h.endColIdx>g.Left.endColIdx||"Center"===t&&h.endColIdx>g.Center.endColIdx||"BottomLeft"===t&&h.endColIdx>g.BottomLeft.endColIdx||"BottomCenter"===t&&h.endColIdx>g.BottomCenter.endColIdx;eZ(h,ek)?r&&(B=!0):(r&&ej(h,v)||!r&&!l)&&(o||a||(B=!0))}return e_(eA,{children:eL("div",{className:`rgPartialArea ${i??""}`,style:{...d,width:A,height:_,boxSizing:"border-box",position:"sticky",pointerEvents:"none",...c,...L},children:[e_("div",{style:{position:"absolute",top:`-${s.gap.width}`,right:`-${s.gap.width}`,bottom:`-${s.gap.width}`,left:`-${s.gap.width}`,...y&&{borderTop:`${u.width} ${u.style} ${u.color}`},...m&&{borderRight:`${u.width} ${u.style} ${u.color}`},...b&&{borderBottom:`${u.width} ${u.style} ${u.color}`},...S&&{borderLeft:`${u.width} ${u.style} ${u.color}`}}}),I.id!==tn.id&&B&&e_("div",{className:"rg-touch-fill-handle",style:{position:"absolute",display:"flex",justifyContent:"center",alignItems:"center",right:-15,bottom:-15,width:30,height:30,pointerEvents:"auto",touchAction:"none"},onPointerDown:e=>{"mouse"!==e.pointerType&&p(t6)},children:e_("div",{className:"rg-fill-handle",style:{width:6.5,height:6.5,backgroundColor:l?u.color:s.focusIndicator.border.color,cursor:"crosshair",boxSizing:"content-box",pointerEvents:"auto",border:"2px solid #fff",borderRadius:"50%"},onPointerDown:()=>p(t6)})})]})})},(e,t)=>{let{startRowIdx:n,endRowIdx:o,startColIdx:r,endColIdx:l}=e.areaRange,{startRowIdx:a,endRowIdx:d,startColIdx:i,endColIdx:s}=t.areaRange;return!(n!==a||o!==d||r!==i||l!==s||e.getCellOffset!==t.getCellOffset)}),nS=l.memo(({range:e,getCellOffset:t=()=>({}),stickyOffsets:n})=>{let{startRowIdx:o,endRowIdx:r,startColIdx:a,endColIdx:d}=e,i=nw(),s=nd()[i].getState(),c=ns(i,e=>e.rows).slice(o,r),u=ns(i,e=>e.columns).slice(a,d),f=ns(i,e=>e.cells),x=ns(i,e=>e.focusedLocation),I=ns(i,e=>e.selectedArea),p=ns(i,e=>e.currentBehavior),h=(0,l.useRef)(p.id),g=(0,l.useRef)(I);(0,l.useEffect)(()=>()=>{h.current=p.id,g.current=I},[p.id,I]);let w=(0,l.useCallback)(t,[n]);return c.map((e,t)=>u.map((e,n)=>{let r=f.get(`${o+t} ${a+n}`);if(!r||eq(r))return null;let l=o+t,d=a+n,i=!1;if((h.current===tU.id||h.current===tO.id)&&p.id===tQ().id){let e=g.current;i=e6(s,r,{startRowIdx:Math.min(e.startRowIdx,I.startRowIdx),endRowIdx:Math.max(e.endRowIdx,I.endRowIdx),startColIdx:Math.min(e.startColIdx,I.startColIdx),endColIdx:Math.max(e.endColIdx,I.endColIdx)})}let c=e6(s,r,I),u=x.rowIndex===l&&x.colIndex===d;return e_(nm,{rowIndex:t,colIndex:n,cell:r,rowSpan:r.rowSpan,colSpan:r.colSpan,realRowIndex:l,realColumnIndex:d,getCellOffset:w,shouldRenderReorderedCells:i,isCellSelected:c,isFocused:u},`${l}-${d}`)}))},(e,t)=>{let{startRowIdx:n,endRowIdx:o,startColIdx:r,endColIdx:l}=e.range,{startRowIdx:a,endRowIdx:d,startColIdx:i,endColIdx:s}=t.range;return!(n!==a||o!==d||r!==i||l!==s||e.getCellOffset!==t.getCellOffset)}),nA=(e,t,n)=>{let o={position:"sticky",gridRowStart:t.startRowIdx+1,gridRowEnd:t.endRowIdx+1,gridColumnStart:t.startColIdx+1,gridColumnEnd:t.endColIdx+1,backgroundColor:n.color};return("TopLeft"===e||"TopCenter"===e||"TopRight"===e)&&(o={...o,top:0,height:`calc(100% + 2*${n.width})`,marginTop:`-${n.width}`}),("TopRight"===e||"Right"===e||"BottomRight"===e)&&(o={...o,right:0,width:`calc(100% + 2*${n.width})`,marginLeft:`-${n.width}`}),("BottomLeft"===e||"BottomCenter"===e||"BottomRight"===e)&&(o={...o,bottom:0,height:`calc(100% + 2*${n.width})`,marginTop:`-${n.width}`}),("TopLeft"===e||"Left"===e||"BottomLeft"===e)&&(o={...o,left:0,width:`calc(100% + 2*${n.width})`,marginLeft:`-${n.width}`}),o},n_=({paneName:e,style:t,gridContentRange:n,getCellOffset:o,stickyOffsets:r,shouldRender:l=!0})=>{let a=nC(),d=nw(),i=ns(d,e=>e.getFocusedCell()),s=i?{startRowIdx:i.rowIndex,endRowIdx:i.rowIndex+(i.rowSpan??1),startColIdx:i.colIndex,endColIdx:i.colIndex+(i.colSpan??1)}:ek,c=ns(d,e=>e.selectedArea),u=ns(d,e=>e.fillHandleArea),f=!eZ(u,ek);return l?eL("div",{className:`rgPane rgPane-${e}`,style:{display:"contents",...t},children:["Center"!==e&&e_("div",{className:`rgPaneBackground rgPaneBackground-${e}`,style:nA(e,n,a.gap)}),e_(nS,{range:n,getCellOffset:o,stickyOffsets:r}),f&&e_(nb,{areaRange:u,parentPaneRange:n,parentPaneName:e,getCellOffset:o,isFillHandlePartial:!0,border:a.fillHandle.border,style:{background:a.focusIndicator.background},className:"rgFillHandleIndicator"}),c&&!ej(s,c)&&e_(nb,{areaRange:{startRowIdx:c.startRowIdx,endRowIdx:c.endRowIdx,startColIdx:c.startColIdx,endColIdx:c.endColIdx},parentPaneRange:n,parentPaneName:e,getCellOffset:o,border:a.selectionIndicator.border,style:{background:a.selectionIndicator.background},className:"rgSelectionIndicator"}),i&&e_(nb,{areaRange:s,parentPaneRange:n,parentPaneName:e,getCellOffset:o,isFocusedCellPartial:!0,border:a.focusIndicator.border,style:{background:a.focusIndicator.background},className:"rgFocusIndicator"})]}):null},nL=(e,t,n="forward")=>{if(!e.length)return[];let o=e[0].offsetTop,r=[o];if("forward"===n)for(let n=1;n<t;n++)r.push(e[n].offsetTop);else{let n=e.length-1;for(let l=n-1;l>=e.length-t;l--){let t=r[n-l-1]+e[l+1].height+o;r.push(t+o)}}return r},nB=(e,t,n="forward")=>{if(!e.length)return[];let o=e[0].offsetLeft,r=[o];if("forward"===n)for(let n=1;n<t;n++)r.push(e[n].offsetLeft);else{let n=e.length-1;for(let l=n-1;l>=e.length-t;l--){let t=r[n-l-1]+e[l+1].width+o;r.push(t)}}return r},nj=(e,t,n)=>{let o={position:"sticky",gridRowStart:t.startRowIdx+1,gridRowEnd:t.endRowIdx+1,gridColumnStart:t.startColIdx+1,gridColumnEnd:t.endColIdx+1};return"Top"===e&&(o={...o,top:0,height:`calc(100% + 2*${n.width})`,marginTop:`-${n.width}`}),"Right"===e&&(o={...o,right:0,width:`calc(100% + 2*${n.width})`,marginLeft:`-${n.width}`}),"Bottom"===e&&(o={...o,bottom:0,height:`calc(100% + 2*${n.width})`,marginTop:`-${n.width}`}),"Left"===e&&(o={...o,left:0,width:`calc(100% + 2*${n.width})`,marginLeft:`-${n.width}`}),o},nk=({paneShadowName:e,style:t,gridContentRange:n,shouldRender:o=!0})=>{let r;let l=nC();return o?("Left"===e?r=l.paneContainer.left.boxShadow:"Right"===e?r=l.paneContainer.right.boxShadow:"Top"===e?r=l.paneContainer.top.boxShadow:"Bottom"===e&&(r=l.paneContainer.bottom.boxShadow),e_("div",{className:`rgPaneShadow rgPaneShadow-${e}`,style:{...t,display:"contents"},children:e_("div",{className:`rgPaneShadowOverlay rgPaneShadowOverlay-${e}`,style:{...nj(e,n,l.gap),boxShadow:r}})})):null},nT=({rowAmount:e,columnAmount:t,stickyTopRows:n,stickyBottomRows:o,stickyLeftColumns:r,stickyRightColumns:a})=>{let d=nw(),i=nd()[d].getState(),s=nC(),c=ns(d,e=>e.cells),u=ns(d,e=>e.rows),f=ns(d,e=>e.focusedLocation),x=ns(d,e=>e.columns),I=ns(d,e=>e.setPaneRanges),p=ns(d,e=>e.setRowMeasurements),h=ns(d,e=>e.setColMeasurements),g=ns(d,e=>e.onCellFocused),w=(0,l.useMemo)(()=>({TopLeft:{startRowIdx:0,endRowIdx:n,startColIdx:0,endColIdx:r},TopCenter:{startRowIdx:0,endRowIdx:n,startColIdx:r,endColIdx:t-a},TopRight:{startRowIdx:0,endRowIdx:n,startColIdx:t-a,endColIdx:t},Left:{startRowIdx:n,endRowIdx:e-o,startColIdx:0,endColIdx:r},Center:{startRowIdx:n,endRowIdx:e-o,startColIdx:r,endColIdx:t-a},Right:{startRowIdx:n,endRowIdx:e-o,startColIdx:t-a,endColIdx:t},BottomLeft:{startRowIdx:e-o,endRowIdx:e,startColIdx:0,endColIdx:r},BottomCenter:{startRowIdx:e-o,endRowIdx:e,startColIdx:r,endColIdx:t-a},BottomRight:{startRowIdx:e-o,endRowIdx:e,startColIdx:t-a,endColIdx:t}}),[n,r,a,e,t,o]);(0,l.useEffect)(()=>{null==g||g(f)},[f]),(0,l.useEffect)(()=>{null==c||c.forEach(e=>{let t=eJ(i,e);eq(e)||(t.startRowIdx<w.TopCenter.endRowIdx&&t.endRowIdx>w.TopCenter.endRowIdx&&console.error(`Cell with indexes [${e.rowIndex}, ${e.colIndex}] does not fit in sticky top pane.`),t.endRowIdx>w.BottomCenter.startRowIdx&&t.startRowIdx<w.BottomCenter.startRowIdx&&console.error(`Cell with indexes [${e.rowIndex}, ${e.colIndex}] does not fit in sticky bottom pane.`),t.startColIdx<w.Left.endColIdx&&t.endColIdx>w.Left.endColIdx&&console.error(`Cell with indexes [${e.rowIndex}, ${e.colIndex}] does not fit in sticky left pane.`),t.endColIdx>w.Right.startColIdx&&t.startColIdx<w.Right.startColIdx&&console.error(`Cell with indexes [${e.rowIndex}, ${e.colIndex}] does not fit in sticky right pane.`))}),I(w)},[w]);let[C,R]=(0,l.useState)({topRows:[],bottomRows:[],leftColumns:[],rightColumns:[]}),v=(0,l.useRef)(null),y=(0,l.useRef)(new ResizeObserver(()=>{let e=m(),t=b();p(e),h(t),R(()=>({topRows:nL(e,n,"forward"),bottomRows:nL(e,o,"backward"),leftColumns:nB(t,r,"forward"),rightColumns:nB(t,a,"backward")}))}));(0,l.useEffect)(()=>{if(!v.current)return;let e=y.current;return e.observe(v.current),()=>e.disconnect()},[]);let m=()=>{if(0===e||!v.current)return[];let n=parseFloat(window.getComputedStyle(v.current).gap??"0"),o=[],r=0,l=0;do{let e=v.current.getElementsByClassName(`rgRowIdx-${r} rgColIdx-${l}`)[0];if(e){let t=window.getComputedStyle(e);if(t.gridRowEnd.includes("span")){l+=parseInt(t.gridRowEnd.split(" ").at(-1)??"1");continue}let a=e.getBoundingClientRect().height,d=0===r?n:o[r-1].offsetTop+o[r-1].height+n;o.push({height:a,offsetTop:d}),l=0,r++,y.current.observe(e);continue}l++}while(r<e&&l<t);return o},b=()=>{if(0===t||!v.current)return[];let n=parseFloat(window.getComputedStyle(v.current).gap??"0"),o=[],r=0,l=0;do{let e=v.current.getElementsByClassName(`rgColIdx-${r} rgRowIdx-${l}`)[0];if(e){let t=window.getComputedStyle(e);if(t.gridColumnEnd.includes("span")){l+=parseInt(t.gridColumnEnd.split(" ").at(-1)??"1");continue}let a=e.getBoundingClientRect().width,d=0===r?n:o[r-1].offsetLeft+o[r-1].width+n;o.push({width:a,offsetLeft:d}),l=0,r++,y.current.observe(e);continue}l++}while(r<t&&l<e);return o},S=s.paneContainer.top.background,A=s.paneContainer.bottom.background,_=s.paneContainer.left.background,L=s.paneContainer.right.background;return e_("div",{css:{display:"flex",userSelect:"none",".rgCellContainer":{paddingTop:s.cellContainer.padding.top,paddingLeft:s.cellContainer.padding.left,paddingBottom:s.cellContainer.padding.bottom,paddingRight:s.cellContainer.padding.right,backgroundColor:s.cellContainer.background}},children:eL("div",{className:"rgGridContent",style:{display:"grid",gridTemplateColumns:x.map(({width:e,minWidth:t})=>{let n=ts(e),o=ts(t??0);return n<o?`${o}px`:`${n}px`}).join(" "),gridTemplateRows:u.map(({height:e})=>"number"==typeof e?`${e}px`:e).join(" "),gap:s.gap.width,backgroundColor:s.gap.color,padding:s.gap.width},ref:v,children:[e_(n_,{paneName:"Center",gridContentRange:w.Center}),e_(nk,{paneShadowName:"Bottom",gridContentRange:{...w.BottomCenter,startColIdx:0,endColIdx:t},shouldRender:o>0&&!!s.paneContainer.bottom.boxShadow}),e_(n_,{paneName:"BottomCenter",gridContentRange:w.BottomCenter,stickyOffsets:C,getCellOffset:(e,t,n)=>({position:"sticky",...A&&{backgroundColor:A},bottom:C.bottomRows.at(-e-n)}),shouldRender:o>0}),e_(nk,{paneShadowName:"Top",gridContentRange:{...w.TopCenter,startColIdx:0,endColIdx:t},shouldRender:n>0&&!!s.paneContainer.top.boxShadow}),e_(n_,{paneName:"TopCenter",gridContentRange:w.TopCenter,stickyOffsets:C,getCellOffset:e=>({position:"sticky",...S&&{backgroundColor:S},top:C.topRows[e]}),shouldRender:n>0}),e_(nk,{paneShadowName:"Right",gridContentRange:{...w.Right,startRowIdx:0,endRowIdx:e},shouldRender:a>0&&!!s.paneContainer.right.boxShadow}),e_(n_,{paneName:"Right",gridContentRange:w.Right,stickyOffsets:C,getCellOffset:(e,t,n,o)=>({position:"sticky",...L&&{backgroundColor:L},right:C.rightColumns.at(-t-o)}),shouldRender:a>0}),e_(nk,{paneShadowName:"Left",gridContentRange:{...w.Left,startRowIdx:0,endRowIdx:e},shouldRender:r>0&&!!s.paneContainer.left.boxShadow}),e_(n_,{paneName:"Left",gridContentRange:w.Left,stickyOffsets:C,getCellOffset:(e,t)=>({position:"sticky",..._&&{backgroundColor:_},left:C.leftColumns[t]}),shouldRender:r>0}),e_(n_,{paneName:"BottomRight",gridContentRange:w.BottomRight,stickyOffsets:C,getCellOffset:(e,t,n,o)=>({position:"sticky",...A&&{backgroundColor:A},bottom:C.bottomRows.at(-e-n),right:C.rightColumns.at(-t-o)}),shouldRender:o>0&&a>0}),e_(n_,{paneName:"BottomLeft",gridContentRange:w.BottomLeft,stickyOffsets:C,getCellOffset:(e,t,n)=>({position:"sticky",...A&&{backgroundColor:A},bottom:C.bottomRows.at(-e-n),left:C.leftColumns[t]}),shouldRender:o>0&&r>0}),e_(n_,{paneName:"TopRight",gridContentRange:w.TopRight,stickyOffsets:C,getCellOffset:(e,t,n,o)=>({position:"sticky",...S&&{backgroundColor:S},top:C.topRows[e],right:C.rightColumns.at(-t-o)}),shouldRender:n>0&&a>0}),e_(n_,{paneName:"TopLeft",gridContentRange:w.TopLeft,stickyOffsets:C,getCellOffset:(e,t)=>({position:"sticky",...S&&{backgroundColor:S},top:C.topRows[e],left:C.leftColumns[t]}),shouldRender:n>0&&r>0})]})})},n$=()=>{let e=nw(),t=ns(e,e=>e.lineOrientation),n=ns(e,e=>e.linePosition),o=ns(e,e=>e.reactGridRef),r=nC(),l="vertical"===t;return e_("div",{className:`rg-line ${l?"rg-line-vertical":"rg-line-horizontal"}`,style:{position:"absolute",height:l?null==o?void 0:o.clientHeight:r.line.size,top:l?0:n,left:l?n:0,width:l?r.line.size:null==o?void 0:o.scrollWidth,backgroundColor:r.line.backgroundColor,pointerEvents:"none"}})},nP=()=>{let e=nw(),t=ns(e,e=>e.lineOrientation),n=ns(e,e=>e.shadowPosition),o=ns(e,e=>e.shadowSize),r=ns(e,e=>e.reactGridRef),l=nC(),a="vertical"===t;return e_("div",{className:`rg-line ${a?"rg-shadow-vertical":"rg-shadow-horizontal"}`,style:{position:"absolute",height:a?null==r?void 0:r.clientHeight:o,top:a?0:n,left:a?n:0,width:a?o:null==r?void 0:r.scrollWidth,backgroundColor:l.shadow.backgroundColor,pointerEvents:"none"}})},nO=({rowIdx:e,colIdx:t})=>{let n=ns(nw(),e=>e.changedFocusedLocation);return(0,l.useEffect)(()=>{var e;n&&(null==(e=tg(n.rowIndex,n.colIndex))||e.focus())},[n]),e_("div",{style:{position:"absolute",bottom:0,right:"50%"},children:e_("input",{onKeyDown:e=>{"Tab"===e.key&&e.preventDefault()},className:`rgHiddenFocusTarget rgFocusRowIdx-${e} rgFocusColIdx-${t}`,style:{width:1,height:1,opacity:0,cursor:"default"},inputMode:"none"})})},nE=()=>{let e=nC(),t=nw(),n=ny(),o=ns(t,e=>e.resizingColIdx),r=ns(t,e=>e.columns),l=ns(t,e=>e.shadowSize),a=ns(t,e=>e.onResizeColumn),d=ns(t,e=>e.setCurrentBehavior),i=ns(t,e=>e.setResizingColIdx),s=r[n.realColumnIndex];return void 0===o&&a&&(null==s?void 0:s.resizable)&&!l&&e_("div",{className:"rg-resize-column",onPointerDown:()=>{i(n.realColumnIndex),d(no)},css:{cursor:"col-resize",...e.resizeColumn.default,"&:hover":{...e.resizeColumn.hover}}})},nF=({children:e,onStringValueRequested:t,onStringValueReceived:n,...o})=>{let{className:r,style:l}=o,a=ny(),d=nw(),i=ns(d,e=>e.enableColumnSelectionOnFirstRow),s=ns(d,e=>e.enableRowSelectionOnFirstColumn),c=a.isFocused||0===a.realRowIndex&&i||0===a.realColumnIndex&&s;return ns(d,e=>e.cellsLookup).set(`${a.realRowIndex} ${a.realColumnIndex}`,{rowIndex:a.realRowIndex,colIndex:a.realColumnIndex,onStringValueRequested:t,onStringValueReceived:n}),eL("div",{...o,className:`rgCellContainer rgRowIdx-${a.realRowIndex} rgColIdx-${a.realColumnIndex} ${r??""}`,style:{minHeight:0,padding:".2rem",position:"relative",display:"flex",alignItems:"center",justifyContent:"center",outline:"none",overflow:"hidden",touchAction:c?"none":"auto",...l,...a.containerStyle,...(null==l?void 0:l.backgroundColor)&&{backgroundColor:l.backgroundColor}},children:[0===a.realRowIndex&&e_(nE,{}),e,e_(nO,{colIdx:a.realColumnIndex,rowIdx:a.realRowIndex})]})},nD=({value:e,style:t})=>e_(nF,{onStringValueRequested:()=>(null==e?void 0:e.toString())||"",onStringValueReceived:()=>{},style:t,children:e}),nM=(e,t,n)=>{let o=new Map,r=new Map;n({setCell:(e,t,n,l,{...a})=>{if(-1===e)throw Error(`Row with id "${e}" isn't defined in rows array`);if(-1===t)throw Error(`Column with id "${t}" isn't defined in columns array`);let d={rowIndex:e,colIndex:t,Template:n,props:l,...Object.fromEntries(Object.entries(a).filter(([e,t])=>void 0!==t))},i=a.rowSpan??1,s=a.colSpan??1;for(let n=0;n<i;n++){let l=e+n;for(let a=0;a<s;a++){let d=t+a;if(0===n&&0===a)continue;let i={originRowIndex:e,originColIndex:t};r.set(`${l} ${d}`,{}),o.set(`${l} ${d}`,i)}}r.set(`${e} ${t}`,{}),o.set(`${e} ${t}`,d)}});let l=Math.max(...Array.from(o.values()).map(e=>e.rowIndex??-1)),a=Math.max(...Array.from(o.values()).map(e=>e.colIndex??-1));for(let e=0;e<=l;e++)for(let t=0;t<=a;t++){let n=`${e} ${t}`;o.has(n)||o.set(n,{rowIndex:e,colIndex:t,Template:nD,props:{value:""}})}return{cellsLookup:r,cells:o,rows:nz(l,e),columns:nH(a,t)}},nz=(e,t)=>{let n=new Map;return t&&t.forEach(e=>{n.set(e.rowIndex,e)}),Array.from({length:e+1}).map((e,t)=>{let o=n.get(t);return{rowIndex:t,height:(null==o?void 0:o.height)??25,reorderable:(null==o?void 0:o.reorderable)??!0}})},nH=(e,t)=>{let n=new Map;return t&&t.forEach(e=>{n.set(e.colIndex,e)}),Array.from({length:e+1}).map((e,t)=>{let o=n.get(t);return{colIndex:t,resizable:(null==o?void 0:o.resizable)??!0,reorderable:(null==o?void 0:o.reorderable)??!0,width:(null==o?void 0:o.width)??150,minWidth:(null==o?void 0:o.minWidth)??150}})},nN=(e,t,n)=>{(0,l.useEffect)(()=>{var o;if(t.initialFocusLocation){let{rowIndex:r,colIndex:l}=t.initialFocusLocation;if(!e.getCellByIndexes(r,l))return;let a=e.getCellOrSpanMemberByIndexes(r,l);n&&(a?eq(a)&&console.error("The provided 'initialFocusLocation' is invalid as it targets !"):console.error("The provided 'initialFocusLocation' does not exist!")),null==(o=tg(r,l))||o.focus()}},[])},nV=(e,t,n)=>{(0,l.useEffect)(()=>{if(t.initialSelectedRange){n&&console.warn("If you set initial selected range, be careful, as it may cut-trough spanned cells in an unintended way!"),t.initialFocusLocation&&n&&(e.getCellByIndexes(t.initialFocusLocation.rowIndex,t.initialFocusLocation.colIndex)||n&&console.error("There is no cell with indexes passed in initialFocusLocation prop."));let o=e$(e,t.initialSelectedRange);e.setSelectedArea(o)}},[])};for(var nU=[],nG=0;nG<256;++nG)nU.push((nG+256).toString(16).slice(1));var nW,nX,nZ,nY,nq,nK=new Uint8Array(16);let nJ={randomUUID:"u">typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)},nQ=(e,t,n)=>{(0,l.useEffect)(()=>{e.setExternalData({...n})},[n]),(0,l.useEffect)(()=>{eZ(t.rows,e.rows)||e.setExternalData({rows:t.rows})},[t.rows]),(0,l.useEffect)(()=>{eZ(t.columns,e.columns)||e.setExternalData({columns:t.columns})},[t.columns]),(0,l.useEffect)(()=>{eZ(t.cells,e.cells)||e.setExternalData({cells:t.cells})},[t.cells])},n0=({id:e,stickyTopRows:t,stickyBottomRows:n,stickyLeftColumns:o,stickyRightColumns:r,rows:a,columns:d,cells:i,...s})=>{var c,u,f;let x=(0,l.useRef)(e??`rg-${function(e,t,n){if(nJ.randomUUID&&!e)return nJ.randomUUID();var o=(e=e||{}).random||(e.rng||function(){if(!nq&&!(nq="u">typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)))throw Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return nq(nK)})();return o[6]=15&o[6]|64,o[8]=63&o[8]|128,function(e,t=0){return(nU[e[t+0]]+nU[e[t+1]]+nU[e[t+2]]+nU[e[t+3]]+"-"+nU[e[t+4]]+nU[e[t+5]]+"-"+nU[e[t+6]]+nU[e[t+7]]+"-"+nU[e[t+8]]+nU[e[t+9]]+"-"+nU[e[t+10]]+nU[e[t+11]]+nU[e[t+12]]+nU[e[t+13]]+nU[e[t+14]]+nU[e[t+15]]).toLowerCase()}(o)}()}`),I=function(e,t){let n=(0,l.useRef)(),o=(0,l.useRef)();return eZ(n.current,t)||(n.current=tI(t),o.current=e()),o.current}(()=>nM(a,d,({setCell:e})=>{i.forEach(t=>{if(null===t)return;let{Template:n,rowIndex:o,colIndex:r,props:l,...a}=t;e(o,r,n,l,a)})}),[a,d,i]);u=x.current,f={...s,...I},nd.setState(e=>e[u]?e:{...e,[u]:eE()((e,t)=>({...ni,...f,behaviors:{...ni.behaviors,...null==f?void 0:f.behaviors},getRowAmount:()=>t().rows.length,getColumnByIdx:e=>t().columns[e],setExternalData:n=>e(()=>({...n,behaviors:{...t().behaviors,...n.behaviors}})),setCellsLookup:t=>e(()=>({cellsLookup:t})),getCellsLookup:()=>t().cellsLookup,getColumnAmount:()=>t().columns.length,getColumnCells:e=>{let{cells:n}=t();return Array.from(n.values()).flat().filter(t=>eq(t)?t.originColIndex===e:t.colIndex===e)},setStyles:t=>e(()=>({styles:t})),getCellByIndexes:(e,n)=>{let{cells:o}=t();if(-1===e||-1===n)return null;let r=o.get(`${e} ${n}`);return r?eq(r)?o.get(`${r.originRowIndex} ${r.originColIndex}`):r:null},getCellOrSpanMemberByIndexes:(e,n)=>{let{rows:o,columns:r,cells:l}=t(),a=o[e],d=r[n];return a&&d&&l.get(`${e} ${n}`)||null},setRowMeasurements:t=>e(()=>({rowMeasurements:t})),setColMeasurements:t=>e(()=>({colMeasurements:t})),setPaneRanges:t=>e(()=>({paneRanges:t})),getPaneRanges:()=>{let{paneRanges:e}=t();return e},setFocusedLocation:(t,n)=>{var o;null==(o=tg(t,n))||o.focus(),e(()=>({focusedLocation:{rowIndex:t,colIndex:n}}))},getFocusedCell:()=>{let{focusedLocation:e}=t(),n=t().getCellByIndexes(e.rowIndex,e.colIndex);return n?{...n,...e}:null},getSelectedArea:()=>{let{selectedArea:e}=t();return e},setSelectedArea:t=>e(()=>({selectedArea:t})),setSelectedColumns:(e,n)=>{let{setSelectedArea:o}=t();o({startRowIdx:0,endRowIdx:t().getRowAmount(),startColIdx:e,endColIdx:n})},setSelectedRows:(e,n)=>{let{setSelectedArea:o}=t();o({startRowIdx:e,endRowIdx:n,startColIdx:0,endColIdx:t().getColumnAmount()})},setFillHandleArea:t=>e(()=>({fillHandleArea:t})),setCurrentBehavior:t=>e(()=>({currentBehavior:t})),setResizingColIdx:t=>e(()=>({resizingColIdx:t})),setLineOrientation:t=>e(()=>({lineOrientation:t})),setLinePosition:t=>e(()=>({linePosition:t})),assignReactGridRef:t=>e(()=>({reactGridRef:t})),getBehavior:e=>{var n;let o=null==(n=t().behaviors)?void 0:n[e];if(!o)throw Error(`Behavior with id "${e}" doesn't exist!`);return o},getStyledRanges:e=>{let n=t().styledRanges;if(!e)return n||[];{let t=n.find(t=>{JSON.stringify(t.range),JSON.stringify(e)});return t?[t]:[]}}}))});let p=nd()[x.current].getState();nQ(p,I,s),nV(p,s,!1),nN(p,s,!1);let h=ns(x.current,e=>e.currentBehavior),g=ns(x.current,e=>e.linePosition),[w,C]=(0,l.useState)(!1);return e_(ng,{id:x.current,children:e_(eB,{children:eL(np,{reactGridId:x.current,style:{position:"relative",...null==(c=s.styles)?void 0:c.gridWrapper},children:[e_(nT,{rowAmount:I.rows.length,columnAmount:I.columns.length,stickyTopRows:t??0,stickyBottomRows:n??0,stickyLeftColumns:o??0,stickyRightColumns:r??0}),g&&e_(n$,{}),tq(h.id)&&e_(nP,{})]})})})},n1=(e,t)=>{let[n,o]=(0,l.useState)(0);return{handleDoubleTouch:()=>{if(!e.isFocused)return;let r=new Date().getTime(),l=r-n;l<300&&l>0&&t(!0),o(r)}}},n5=(e,t=[])=>{let n=["Shift","Alt","ArrowLeft","ArrowRight","ArrowUp","ArrowDown"," ","Tab","PageDown","PageUp","Home","End","Insert","Delete","Backspace","Escape","CapsLock","Enter","F1","F2","F3","F4","F5","F6","F7","F8","F9","F10","F11","F12",...t],o=e.ctrlKey||e.metaKey;return!(n.includes(e.key)||n.some(t=>e[t])||o)},n2=({text:e,onTextChanged:t,style:n})=>{let o=ny(),r=(0,l.useRef)(null),[a,d]=(0,l.useState)(!1),[i,s]=(0,l.useState)(e||""),{handleDoubleTouch:c}=n1(o,d);return(0,l.useEffect)(()=>{s(e)},[e]),e_(nF,{onStringValueRequested:()=>e,onStringValueReceived:e=>null==t?void 0:t(e),onTouchEnd:c,style:n,onDoubleClick:()=>{o.isFocused&&(s(e||""),d(!0))},onKeyDown:t=>{!a&&n5(t,[])?(t.stopPropagation(),s(""),d(!0)):a||o.isCellSelected||"Enter"!==t.key&&"F2"!==t.key||(t.stopPropagation(),s(e||""),d(!0))},children:a?e_("input",{className:"rg-input",value:i,onChange:e=>s(e.currentTarget.value),onBlur:e=>{null==t||t(e.currentTarget.value),d(!1)},onCut:e=>e.stopPropagation(),onCopy:e=>e.stopPropagation(),onPaste:e=>e.stopPropagation(),onPointerDown:e=>e.stopPropagation(),onKeyDown:e=>{["Escape","Enter","Tab"].includes(e.key)||e.stopPropagation(),"Escape"===e.key?d(!1):"Enter"===e.key&&(null==t||t(e.currentTarget.value),d(!1))},autoFocus:!0,ref:r}):e})},n4=({value:e,style:t,onValueChanged:n,validator:o,errorMessage:r,hideZero:a,allowSeparators:d=!0,format:i})=>{let s=null==e?void 0:e.toString(),c=ny(),u=(0,l.useRef)(null),[f,x]=(0,l.useState)(!1),[I,p]=(0,l.useState)(s||"0"),{handleDoubleTouch:h}=n1(c,x),g=!o||o(Number(e));(0,l.useEffect)(()=>{p(s)},[e]);let w=[".",","];return e_(nF,{onTouchEnd:h,onStringValueRequested:()=>s,onStringValueReceived:e=>null==n?void 0:n(Number(e)),style:t,onDoubleClick:()=>{c.isFocused&&(p(s||"0"),x(!0))},onKeyDown:e=>{!f&&"0123456789".includes(e.key)||d&&w.includes(e.key)?(p(""),x(!0)):f||c.isCellSelected||"Enter"!==e.key&&"F2"!==e.key||(e.stopPropagation(),p(s||"0"),x(!0))},children:f?e_("input",{className:"rg-input",value:I,onChange:e=>{let t=e.currentTarget.value.replace(d?/[^0-9,.]/g:/[^0-9]/g,"");w.includes(t)&&(t="0"+t),p(t)},onPointerDown:e=>e.stopPropagation(),onBlur:e=>{let t=e.currentTarget.value.replace(/,/g,".");null==n||n(Number(t)),x(!1)},onCut:e=>e.stopPropagation(),onCopy:e=>e.stopPropagation(),onPaste:e=>e.stopPropagation(),onKeyDown:e=>{if(["Escape","Enter","Tab"].includes(e.key)||e.stopPropagation(),"Escape"===e.key)x(!1);else if("Enter"===e.key){let t=e.currentTarget.value.replace(/,/g,".");null==n||n(Number(t)),x(!1)}},autoFocus:!0,ref:u}):a&&0===e?"":i?i.format(e):!g&&r?r:s})};function n3(e){return nc(e,e=>({setSelectedArea:t=>e.setSelectedArea(t),setFocusedCell:({rowIndex:t,colIndex:n})=>(e.getCellByIndexes(t,n),e.setFocusedLocation(t,n)),setSelectedColumns:(t,n)=>e.setSelectedColumns(t,n),setSelectedRows:(t,n)=>e.setSelectedRows(t,n),getFocusedCell:e.getFocusedCell,getCellByIndexes:e.getCellByIndexes,getCellOrSpanMemberByIndexes:e.getCellOrSpanMemberByIndexes,getPaneRanges:e.getPaneRanges,getCellsLookup:e.getCellsLookup,getSelectedArea:e.getSelectedArea,getRows:()=>e.rows,getColumns:()=>e.columns}))}}}]);